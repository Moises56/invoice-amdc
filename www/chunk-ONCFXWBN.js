import{a as g}from"./chunk-AL5IVEPX.js";import{Va as a,Wa as u,a as h,u as c,x as m}from"./chunk-WYTV4Y2I.js";var b=(()=>{let i=class i{constructor(){this.http=m(u),this.apiUrl=`${g.apiUrl}/mercados`}getMarkets(t={}){let e=new a;return t.page&&(e=e.set("page",t.page.toString())),t.limit&&(e=e.set("limit",t.limit.toString())),t.search&&(e=e.set("search",t.search)),t.estado!==void 0&&(e=e.set("estado",t.estado.toString())),t.municipio&&(e=e.set("municipio",t.municipio)),this.http.get(this.apiUrl,{params:e})}getMarketById(t){return this.http.get(`${this.apiUrl}/${t}`)}createMarket(t){return this.http.post(this.apiUrl,t)}updateMarket(t,e){return this.http.patch(`${this.apiUrl}/${t}`,e)}deleteMarket(t){return this.http.delete(`${this.apiUrl}/${t}`)}toggleMarketStatus(t){return this.http.patch(`${this.apiUrl}/${t}/toggle-status`,{})}getAllMarketStats(){return this.http.get(`${this.apiUrl}/stats`)}getUniqueMunicipios(){return new h(t=>{this.getMarkets({limit:100}).subscribe({next:e=>{let r=e.data||[],p=[...new Set(r.map(s=>{var o;return s.direccion?(o=s.direccion.split(",").pop())==null?void 0:o.trim():""}).filter(s=>s&&s.trim()!==""))];t.next(p),t.complete()},error:e=>{console.error("Error al obtener municipios:",e),t.next([]),t.complete()}})})}getMarketsByMunicipio(t){let e=new a().set("municipio",t);return this.http.get(`${this.apiUrl}/by-municipio`,{params:e})}getMarketStats(t){return this.http.get(`${this.apiUrl}/${t}/stats`)}checkMarketNameAvailability(t,e){let r=new a().set("nombre",t);return e&&(r=r.set("excludeId",e)),this.http.get(`${this.apiUrl}/check-name`,{params:r})}getNearbyMarkets(t,e,r=10){let p=new a().set("lat",t.toString()).set("lng",e.toString()).set("radius",r.toString());return this.http.get(`${this.apiUrl}/nearby`,{params:p})}exportMarkets(t={}){let e=new a;return t.search&&(e=e.set("search",t.search)),t.estado!==void 0&&(e=e.set("estado",t.estado.toString())),t.municipio&&(e=e.set("municipio",t.municipio)),this.http.get(`${this.apiUrl}/export`,{params:e,responseType:"blob"})}};i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=c({token:i,factory:i.\u0275fac,providedIn:"root"});let n=i;return n})();export{b as a};
