import{a as dt}from"./chunk-QC3HO4WT.js";import{a as ct}from"./chunk-5WO2EZYA.js";import"./chunk-B4FAM7CU.js";import{b as lt}from"./chunk-OZ57TRDR.js";import{a as U}from"./chunk-AL5IVEPX.js";import{a as $,b as V,c as W,d as z,e as G,f as J,g as R,h as q,j as K,l as Q,m as X,n as Y,o as Z,p as tt,q as et,r as it,t as nt,u as at,v as ot,y as rt,z as st}from"./chunk-2X2U3RLS.js";import{A as _,B as y,I as C,J as s,Ja as D,Ka as H,M as T,Q as f,Qb as j,Sa as L,Sb as k,T as m,Ua as N,Va as u,Wa as O,Y as i,Z as e,Zb as B,_ as v,ca as w,da as S,ea as E,ma as a,na as c,oa as b,pa as A,ra as M,sa as P,ta as F,u as h,w as g,x as p}from"./chunk-WYTV4Y2I.js";import"./chunk-OQQFKM4V.js";import"./chunk-QUJFQN2Y.js";import"./chunk-J7JITKZC.js";import"./chunk-BOXIHRYD.js";import"./chunk-OHGEMRV5.js";import"./chunk-KLXKYU2M.js";import"./chunk-SIK2P2H5.js";import"./chunk-4BNUL4C7.js";import"./chunk-M66VC23L.js";import"./chunk-JMWLUS2D.js";import"./chunk-EUVXMWSF.js";import"./chunk-LBMIQEU6.js";import"./chunk-WI5MSH4N.js";import"./chunk-USUO6L27.js";import"./chunk-CKP3SGE2.js";import"./chunk-2LFY4CRM.js";import"./chunk-PJL56ILQ.js";import"./chunk-NVWEJ7GR.js";import"./chunk-UVAVEIEI.js";import"./chunk-E6CW6KXY.js";import"./chunk-Z3EESIK6.js";import"./chunk-FXFZIWDD.js";import"./chunk-6WKZVARI.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{h as I}from"./chunk-LNJ3S2LQ.js";var pt=(()=>{let n=class n{constructor(t){this.http=t,this.apiUrlE=U.apiUrlE}get(t,o=new u){return this.http.get(`${this.apiUrlE}${t}`,{params:o,withCredentials:!0})}post(t,o={}){return this.http.post(`${this.apiUrlE}${t}`,JSON.stringify(o),{headers:this.getHeaders(),withCredentials:!0})}put(t,o={}){return this.http.put(`${this.apiUrlE}${t}`,JSON.stringify(o),{headers:this.getHeaders(),withCredentials:!0})}delete(t){return this.http.delete(`${this.apiUrlE}${t}`,{headers:this.getHeaders(),withCredentials:!0})}getHeaders(){return new N({"Content-Type":"application/json"})}};n.\u0275fac=function(o){return new(o||n)(g(O))},n.\u0275prov=h({token:n,factory:n.\u0275fac,providedIn:"root"});let r=n;return r})();var ut=(()=>{let n=class n{constructor(t){this.apiClient=t}getEstadoDeCuenta(t){let o=new u().set("claveCatastral",t);return this.apiClient.get("/estado-cuenta",o)}getEstadoDeCuentaConAmnistia(t){let o=new u().set("claveCatastral",t);return this.apiClient.get("/estado-cuenta/con-amnistia",o)}};n.\u0275fac=function(o){return new(o||n)(g(pt))},n.\u0275prov=h({token:n,factory:n.\u0275fac,providedIn:"root"});let r=n;return r})();function ft(r,n){r&1&&(i(0,"div",9),v(1,"ion-spinner"),e())}function vt(r,n){if(r&1&&(i(0,"ion-card")(1,"ion-card-header",17)(2,"ion-card-title"),a(3,"Amnist\xEDa Vigente"),e()(),i(4,"ion-card-content")(5,"p"),a(6,"Aproveche la amnist\xEDa hasta el: "),i(7,"strong"),a(8),e()()()()),r&2){let l=E().ngIf;s(8),c(l.fechaFinAmnistia)}}function Et(r,n){if(r&1&&(i(0,"tr")(1,"td"),a(2),e(),i(3,"td"),a(4),e(),i(5,"td"),a(6),e(),i(7,"td"),a(8),e(),i(9,"td")(10,"strong"),a(11),e()()()),r&2){let l=n.$implicit;s(2),c(l.year),s(2),c(l.impuesto),s(2),c(l.trenDeAseo),s(2),c(l.tasaBomberos),s(3),c(l.total)}}function xt(r,n){if(r&1){let l=w();i(0,"div")(1,"ion-card")(2,"ion-card-header")(3,"ion-card-title"),a(4),e(),i(5,"ion-card-subtitle"),a(6),e()(),i(7,"ion-card-content")(8,"p")(9,"strong"),a(10,"Clave Catastral:"),e(),a(11),e(),i(12,"p")(13,"strong"),a(14,"Colonia:"),e(),a(15),e(),i(16,"p")(17,"strong"),a(18,"Fecha:"),e(),a(19),e()()(),f(20,vt,9,1,"ion-card",8),i(21,"ion-card")(22,"ion-card-header")(23,"ion-card-title"),a(24,"Detalle de la Mora"),e()(),i(25,"ion-card-content")(26,"div",10)(27,"table")(28,"thead")(29,"tr")(30,"th"),a(31,"A\xF1o"),e(),i(32,"th"),a(33,"Impuesto"),e(),i(34,"th"),a(35,"Tren de Aseo"),e(),i(36,"th"),a(37,"Bomberos"),e(),i(38,"th"),a(39,"Total"),e()()(),i(40,"tbody"),f(41,Et,12,5,"tr",11),e()()(),i(42,"ion-item",12)(43,"ion-label"),a(44,"Total General"),e(),i(45,"ion-note",13),a(46),e()()()(),i(47,"div",14)(48,"ion-button",15),S("click",function(){_(l);let o=E();return y(o.imprimirRecibo())}),v(49,"ion-icon",16),a(50," Imprimir recibo "),e()()()}if(r&2){let l=n.ngIf,t=E();s(4),c(l.nombre),s(2),c(l.identidad),s(5),b(" ",l.claveCatastral,""),s(4),b(" ",l.colonia,""),s(4),A(" ",l.fecha," - ",l.hora,""),s(),m("ngIf",l.amnistiaVigente),s(21),m("ngForOf",l.detallesMora),s(5),c(l.totalGeneral),s(2),m("disabled",t.isLoading()||!t.estadoCuenta())}}var ht=(()=>{let n=class n{constructor(){this.estadoCuentaService=p(ut),this.authService=p(lt),this.toastController=p(rt),this.printingService=p(dt),this.bluetoothService=p(ct),this.estadoCuenta=C(null),this.isLoading=C(!1),this.claveCatastral=C("")}ngOnInit(){let t=this.authService.user();t&&t.claveCatastral&&(this.claveCatastral.set(t.claveCatastral),this.consultarEstadoCuenta())}consultarEstadoCuenta(){let t=this.claveCatastral();if(!t){this.presentToast("Por favor, ingrese una clave catastral.","warning");return}this.isLoading.set(!0),this.estadoCuentaService.getEstadoDeCuentaConAmnistia(t).subscribe({next:o=>{this.estadoCuenta.set(o),this.isLoading.set(!1)},error:o=>{console.error(o),this.isLoading.set(!1),this.presentToast("Error al consultar el estado de cuenta.","danger")}})}presentToast(t,o){return I(this,null,function*(){(yield this.toastController.create({message:t,duration:3e3,color:o,position:"top"})).present()})}imprimirRecibo(){return I(this,null,function*(){let t=this.estadoCuenta();if(!t){this.presentToast("No hay datos para imprimir.","warning");return}if(!(yield this.bluetoothService.isConnected())){this.presentToast("No hay ninguna impresora conectada.","danger");return}try{let d=this.printingService.formatEstadoCuenta(t);yield this.bluetoothService.print(d),this.presentToast("Imprimiendo recibo...","success")}catch{this.presentToast("Error al imprimir el recibo.","danger")}})}};n.\u0275fac=function(o){return new(o||n)},n.\u0275cmp=T({type:n,selectors:[["app-estado-cuenta-amnistia"]],decls:16,vars:5,consts:[[3,"translucent"],["slot","start"],[3,"fullscreen"],["collapse","condense"],["size","large"],[1,"ion-padding"],["label","Clave Catastral","labelPlacement","stacked",3,"ngModelChange","ionChange","ngModel"],["class","ion-text-center ion-padding",4,"ngIf"],[4,"ngIf"],[1,"ion-text-center","ion-padding"],[1,"table-responsive"],[4,"ngFor","ngForOf"],["lines","none",1,"total-general"],["slot","end"],[1,"ion-padding","ion-text-center"],["color","primary",3,"click","disabled"],["name","print-outline","slot","start"],["color","success"]],template:function(o,d){o&1&&(i(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),v(3,"ion-menu-button"),e(),i(4,"ion-title"),a(5,"Estado de Cuenta con Amnist\xEDa"),e()()(),i(6,"ion-content",2)(7,"ion-header",3)(8,"ion-toolbar")(9,"ion-title",4),a(10,"Estado de Cuenta con Amnist\xEDa"),e()()(),i(11,"div",5)(12,"ion-item")(13,"ion-input",6),F("ngModelChange",function(x){return P(d.claveCatastral,x)||(d.claveCatastral=x),x}),S("ionChange",function(){return d.consultarEstadoCuenta()}),e()(),f(14,ft,2,0,"div",7)(15,xt,51,10,"div",8),e()()),o&2&&(m("translucent",!0),s(6),m("fullscreen",!0),s(7),M("ngModel",d.claveCatastral),s(),m("ngIf",d.isLoading()),s(),m("ngIf",!d.isLoading()&&d.estadoCuenta()))},dependencies:[st,V,W,z,G,J,R,q,K,Q,X,Y,Z,tt,et,it,nt,at,ot,$,L,D,H,B,j,k],styles:['@charset "UTF-8";ion-card[_ngcontent-%COMP%]{margin:16px;padding:16px}ion-card-title[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:700;color:var(--ion-color-primary)}.amnesty-info[_ngcontent-%COMP%]{background-color:var(--ion-color-tertiary-tint);border-radius:8px;padding:12px;margin-top:16px}']});let r=n;return r})();var $t=[{path:"",component:ht}];export{$t as routes};
