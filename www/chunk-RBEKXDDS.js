import{a as Me}from"./chunk-KN2IIB5X.js";import"./chunk-HENECHRK.js";import{A as de,Fa as ue,Ka as xe,Ua as he,Va as Ce,Za as Pe,a as ae,d as re,fa as ge,fb as Oe,ga as pe,oa as me,q as le,ua as _e,v as ce,w as se,xa as fe}from"./chunk-FQJECSKX.js";import{$ as m,Ac as oe,Ba as L,Dc as ie,Ea as S,Fa as y,G as _,H as l,Ib as z,Jb as N,K as v,Kb as F,Lb as B,Mb as D,N as C,Na as E,Nb as R,P as g,Pb as V,Qb as A,Rb as j,Sb as $,Tb as G,U as n,Ub as H,V as a,Va as T,Vb as q,W as s,Wb as W,Xb as Y,Yb as J,_ as M,_b as K,aa as p,bc as Q,fc as U,gc as X,ia as c,ic as Z,ja as f,jb as k,ka as u,la as w,mc as ee,oc as te,qc as ne,w as I,y as P,z as O}from"./chunk-2VKWM52Q.js";import"./chunk-JIZFLM72.js";import"./chunk-7KGURMOZ.js";import"./chunk-USFD3CU2.js";import"./chunk-64FPX77P.js";import"./chunk-VWTKY57Y.js";import"./chunk-CKIBZVXW.js";import"./chunk-PS2NURIG.js";import"./chunk-4U6PRYVA.js";import"./chunk-FXFZIWDD.js";import"./chunk-CSG5OQLY.js";import"./chunk-VMHM3MLJ.js";import"./chunk-6WKZVARI.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{f as h}from"./chunk-RW4GY4BD.js";function be(r,d){r&1&&(n(0,"div",17),s(1,"ion-spinner",18),n(2,"p"),c(3,"Cargando locales..."),a()())}function Ie(r,d){if(r&1&&(n(0,"div",28),s(1,"ion-icon",35),n(2,"span",30),c(3),a()()),r&2){let o=p().$implicit,e=p(2);l(3),f(e.formatDNI(o.dni_propietario||""))}}function ve(r,d){if(r&1){let o=M();n(0,"ion-col",20)(1,"ion-card",21),m("click",function(){let i=P(o).$implicit,t=p(2);return O(t.viewLocal(i))}),n(2,"ion-card-header")(3,"div",22),s(4,"ion-icon",23),n(5,"div",24)(6,"ion-card-title",25),c(7),a(),n(8,"ion-badge",26),c(9),a()()()(),n(10,"ion-card-content")(11,"div",27)(12,"div",28),s(13,"ion-icon",29),n(14,"span",30)(15,"strong"),c(16),a(),c(17),a()(),n(18,"div",28),s(19,"ion-icon",31),n(20,"span",30),c(21),a()(),n(22,"div",28),s(23,"ion-icon",32),n(24,"span",30),c(25),a()(),C(26,Ie,4,1,"div",33),n(27,"div",34),s(28,"ion-icon",35),n(29,"span",36),c(30),a()(),n(31,"div",28)(32,"ion-chip",37)(33,"ion-label"),c(34),a()()()()()()()}if(r&2){let o=d.$implicit,e=p(2);g("size",12)("sizeMd",6)("sizeLg",3),l(4),g("name",e.getTipoIcon(o.tipo_local||"")),l(3),u(" ",o.nombre_local==="NO DISPONIBLE"?"Local "+o.numero_local:o.nombre_local," "),l(),g("color",e.getEstadoColor(o.estado_local)),l(),u(" ",o.estado_local," "),l(7),u("No. ",o.numero_local,""),l(),u(" - ",o.tipo_local," "),l(4),f(e.getMercadoNombre(o)),l(4),f(o.propietario),l(),g("ngIf",e.formatDNI(o.dni_propietario||"")!=="N/A"),l(4),f(e.formatMonto((o.monto_mensual==null?null:o.monto_mensual.toString())||"0")),l(4),u("",e.getNumeroFacturas(o)," facturas")}}function we(r,d){if(r&1&&(n(0,"ion-grid")(1,"ion-row"),C(2,ve,35,14,"ion-col",19),a()()),r&2){let o=p();l(2),g("ngForOf",o.locales())}}function Le(r,d){if(r&1){let o=M();n(0,"div",38),s(1,"ion-icon",39),n(2,"h3"),c(3,"No se encontraron locales"),a(),n(4,"p"),c(5),a(),n(6,"ion-button",40),m("click",function(){P(o);let i=p();return O(i.createLocal())}),s(7,"ion-icon",41),c(8," Agregar Local "),a()()}if(r&2){let o=p();l(5),f(o.searchTerm()?"Intenta con otros t\xE9rminos de b\xFAsqueda":"No hay locales registrados")}}function Se(r,d){if(r&1){let o=M();n(0,"ion-infinite-scroll",42),m("ionInfinite",function(i){P(o);let t=p();return O(t.loadMore(i))}),s(1,"ion-infinite-scroll-content",43),a()}}function ye(r,d){if(r&1&&(n(0,"div",44)(1,"p"),c(2),a()()),r&2){let o=p();l(2),w("Mostrando ",o.locales().length," de ",o.totalItems()," locales")}}var je=(()=>{let d=class d{constructor(){this.localesService=I(Me),this.router=I(T),this.locales=_([]),this.loading=_(!1),this.searchTerm=_(""),this.currentPage=_(1),this.totalPages=_(0),this.totalItems=_(0),this.gridCols=L(()=>{let e=window.innerWidth;return e<768?1:e<1200?2:4}),ae({addOutline:re,searchOutline:Pe,locationOutline:fe,personOutline:xe,cardOutline:de,businessOutline:ce,refreshOutline:he,filterOutline:pe,eyeOutline:ge,leafOutline:_e,storefrontOutline:Oe,restaurantOutline:Ce,iceCreamOutline:me,cafeOutline:se,basketOutline:le,nutritionOutline:ue})}ngOnInit(){this.loadLocales()}loadLocales(e=!1){return h(this,null,function*(){this.loading.set(!0);let i={page:e?1:this.currentPage(),limit:12};this.searchTerm()&&(i.search=this.searchTerm());try{let t=yield this.localesService.getLocales(i).toPromise();t&&(this.locales.set(t.data),this.totalPages.set(t.pagination.total_pages),this.totalItems.set(t.pagination.total),this.currentPage.set(t.pagination.current_page))}catch(t){console.error("Error loading locales:",t)}finally{this.loading.set(!1)}})}onSearch(e){return h(this,null,function*(){var t;let i=((t=e.target.value)==null?void 0:t.toLowerCase())||"";this.searchTerm.set(i),this.currentPage.set(1),yield this.loadLocales(!0)})}doRefresh(e){return h(this,null,function*(){yield this.loadLocales(!0),e.target.complete()})}loadMore(e){return h(this,null,function*(){if(this.currentPage()<this.totalPages()){this.currentPage.set(this.currentPage()+1);let i={page:this.currentPage(),limit:12};this.searchTerm()&&(i.search=this.searchTerm());try{let t=yield this.localesService.getLocales(i).toPromise();if(t){let x=this.locales();this.locales.set([...x,...t.data]),this.totalPages.set(t.pagination.total_pages)}}catch(t){console.error("Error loading more locales:",t)}}e.target.complete()})}viewLocal(e){this.router.navigate(["/locales",e.id])}createLocal(){this.router.navigate(["/locales/nuevo"])}formatMonto(e){return this.localesService.formatMontoMensual(e)}getEstadoColor(e){return this.localesService.getEstadoColor(e)}getTipoIcon(e){return this.localesService.getTipoLocalIcon(e)}formatDNI(e){return!e||e==="NO DISPONIBLE"?"N/A":e}formatTelefono(e){return!e||e==="NO DISPONIBLE"?"N/A":e}getMercadoNombre(e){var i;return((i=e.mercado)==null?void 0:i.nombre_mercado)||"Mercado no disponible"}getNumeroFacturas(e){var i;return((i=e._count)==null?void 0:i.facturas)||0}};d.\u0275fac=function(i){return new(i||d)},d.\u0275cmp=v({type:d,selectors:[["app-locales-list"]],decls:22,vars:6,consts:[[2,"--background","#5ccedf"],["slot","start"],[2,"color","white","font-weight","600"],["slot","end"],[2,"color","white",3,"click"],["name","add-outline"],[1,"search-container"],["placeholder","Buscar por mercado, n\xFAmero, DNI o propietario...","show-clear-button","focus",2,"--background","#f8f9fa","--color","#333",3,"ionInput","debounce"],["slot","fixed",3,"ionRefresh"],["pulling-icon","refresh-outline","refreshing-spinner","circular"],["class","loading-container",4,"ngIf"],[4,"ngIf"],["class","empty-state",4,"ngIf"],[3,"ionInfinite",4,"ngIf"],["vertical","bottom","horizontal","end","slot","fixed"],[2,"--background","#5ccedf",3,"click"],["class","stats-footer",4,"ngIf"],[1,"loading-container"],["name","circular",2,"color","#5ccedf"],[3,"size","sizeMd","sizeLg",4,"ngFor","ngForOf"],[3,"size","sizeMd","sizeLg"],[1,"local-card",3,"click"],[1,"card-header-content"],[1,"tipo-icon",2,"color","#5ccedf",3,"name"],[1,"local-info"],[1,"local-title"],[1,"estado-badge",3,"color"],[1,"local-details"],[1,"detail-row"],["name","business-outline",1,"detail-icon"],[1,"detail-text"],["name","location-outline",1,"detail-icon"],["name","person-outline",1,"detail-icon"],["class","detail-row",4,"ngIf"],[1,"detail-row","monto-row"],["name","card-outline",1,"detail-icon"],[1,"monto-text"],["color","primary",1,"facturas-chip"],[1,"empty-state"],["name","storefront-outline",1,"empty-icon"],["fill","solid",2,"--background","#5ccedf",3,"click"],["name","add-outline","slot","start"],[3,"ionInfinite"],["loading-spinner","circular","loading-text","Cargando m\xE1s locales..."],[1,"stats-footer"]],template:function(i,t){i&1&&(n(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),s(3,"ion-menu-button"),a(),n(4,"ion-title",2),c(5,"Gesti\xF3n de Locales"),a(),n(6,"ion-buttons",3)(7,"ion-button",4),m("click",function(){return t.createLocal()}),s(8,"ion-icon",5),a()()()(),n(9,"ion-content")(10,"div",6)(11,"ion-searchbar",7),m("ionInput",function(b){return t.onSearch(b)}),a()(),n(12,"ion-refresher",8),m("ionRefresh",function(b){return t.doRefresh(b)}),s(13,"ion-refresher-content",9),a(),C(14,be,4,0,"div",10)(15,we,3,1,"ion-grid",11)(16,Le,9,1,"div",12)(17,Se,2,0,"ion-infinite-scroll",13),n(18,"ion-fab",14)(19,"ion-fab-button",15),m("click",function(){return t.createLocal()}),s(20,"ion-icon",5),a()(),C(21,ye,3,2,"div",16),a()),i&2&&(l(11),g("debounce",500),l(3),g("ngIf",t.loading()&&t.locales().length===0),l(),g("ngIf",!t.loading()||t.locales().length>0),l(),g("ngIf",!t.loading()&&t.locales().length===0),l(),g("ngIf",t.currentPage()<t.totalPages()),l(4),g("ngIf",t.locales().length>0))},dependencies:[E,S,y,k,$,W,te,ne,F,Q,N,oe,ie,B,D,R,V,z,ee,U,X,Y,J,q,Z,j,A,K,G,H],styles:[".search-container[_ngcontent-%COMP%]{padding:16px;background:linear-gradient(135deg,#5ccedf,#87dbe7)}.search-container[_ngcontent-%COMP%]   ion-searchbar[_ngcontent-%COMP%]{--border-radius: 25px;--box-shadow: 0 4px 12px rgba(92, 206, 223, .2);margin:0}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:50vh}.loading-container[_ngcontent-%COMP%]   ion-spinner[_ngcontent-%COMP%]{margin-bottom:16px;transform:scale(1.5)}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#666;font-size:16px}.local-card[_ngcontent-%COMP%]{margin:8px 0;border-radius:16px;box-shadow:0 4px 12px #0000001a;transition:all .3s ease;cursor:pointer}.local-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 20px #00000026}.local-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]{padding:16px 16px 8px}.local-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{padding:8px 16px 16px}.card-header-content[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:12px}.card-header-content[_ngcontent-%COMP%]   .tipo-icon[_ngcontent-%COMP%]{font-size:24px;margin-top:4px;flex-shrink:0}.card-header-content[_ngcontent-%COMP%]   .local-info[_ngcontent-%COMP%]{flex:1;min-width:0}.card-header-content[_ngcontent-%COMP%]   .local-info[_ngcontent-%COMP%]   .local-title[_ngcontent-%COMP%]{font-size:16px;font-weight:600;margin-bottom:8px;color:#333;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.card-header-content[_ngcontent-%COMP%]   .local-info[_ngcontent-%COMP%]   .estado-badge[_ngcontent-%COMP%]{font-size:12px;padding:4px 8px;border-radius:12px;font-weight:500}.local-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-bottom:8px}.local-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]:last-child{margin-bottom:0}.local-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-icon[_ngcontent-%COMP%]{font-size:16px;color:#666;flex-shrink:0;width:20px}.local-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-text[_ngcontent-%COMP%]{font-size:14px;color:#555;flex:1;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.local-details[_ngcontent-%COMP%]   .monto-row[_ngcontent-%COMP%]{margin-top:12px;padding-top:8px;border-top:1px solid #eee}.local-details[_ngcontent-%COMP%]   .monto-row[_ngcontent-%COMP%]   .monto-text[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#5ccedf}.local-details[_ngcontent-%COMP%]   .facturas-chip[_ngcontent-%COMP%]{margin-top:8px}.local-details[_ngcontent-%COMP%]   .facturas-chip[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-size:12px;font-weight:500}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:50vh;padding:32px;text-align:center}.empty-state[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]{font-size:64px;color:#ddd;margin-bottom:16px}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#666;margin-bottom:8px;font-size:20px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#999;margin-bottom:24px;max-width:300px}.empty-state[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--border-radius: 25px;--padding-start: 20px;--padding-end: 20px}.stats-footer[_ngcontent-%COMP%]{padding:16px;text-align:center;background:#f8f9fa;border-top:1px solid #e9ecef}.stats-footer[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#666;font-size:14px}@media (max-width: 768px){.local-card[_ngcontent-%COMP%]{margin:4px 0}.local-card[_ngcontent-%COMP%]   .card-header-content[_ngcontent-%COMP%]   .local-title[_ngcontent-%COMP%]{font-size:15px}.local-card[_ngcontent-%COMP%]   .local-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-text[_ngcontent-%COMP%]{font-size:13px}.search-container[_ngcontent-%COMP%]{padding:12px}}ion-fab-button[_ngcontent-%COMP%]{--box-shadow: 0 4px 16px rgba(92, 206, 223, .4)}ion-fab-button[_ngcontent-%COMP%]:hover{--box-shadow: 0 6px 20px rgba(92, 206, 223, .5)}ion-grid[_ngcontent-%COMP%]{padding:8px}ion-grid[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{padding:4px}ion-infinite-scroll-content[_ngcontent-%COMP%]   .infinite-loading[_ngcontent-%COMP%]{color:#5ccedf}ion-badge[color=success][_ngcontent-%COMP%]{--background: #28a745}ion-badge[color=danger][_ngcontent-%COMP%]{--background: #dc3545}ion-badge[color=medium][_ngcontent-%COMP%]{--background: #6c757d}"]});let r=d;return r})();export{je as LocalesListPage};
