import{a as re}from"./chunk-VIS7MK3R.js";import{a as ee}from"./chunk-EFKYVIZ2.js";import"./chunk-WJYYOXGJ.js";import"./chunk-GYW6ZFL4.js";import{a as T}from"./chunk-76SUSZ7P.js";import{A as Ve,Ba as He,E as Fe,F as Re,Ha as Ze,J as Ne,Ka as Je,M as Be,P as $e,Q,Qa as Qe,Ua as Xe,X as Ge,Xa as et,Za as tt,a as J,aa as je,cb as it,d as Ae,da as qe,db as rt,fa as We,ga as Ye,hb as at,ib as nt,kb as ot,m as Le,ra as X,rb as st,v as ze,ya as Ke,z as De}from"./chunk-PIGH2764.js";import{$ as Z,C as Ce,G as Pe,H as Se,L as Me,N as j,P as q,R as W,S as Y,V as K,W as Ee,Y as H,Z as Oe,aa as Ue,ca as Ie,ea as Te,i as R,j as N,k as be,l as he,m as fe,o as ve,r as B,s as we,t as _e,v as $,w as xe,x as ke,y as G,z as ye}from"./chunk-SOBSCE5F.js";import"./chunk-AL5IVEPX.js";import{$a as oe,A as f,B as v,Fa as z,I as _,J as o,Ja as ne,Ka as D,M as L,Pb as A,Q as k,Qb as F,Rb as se,S as ie,Sa as V,Sb as le,T as p,Tb as ce,Ub as de,V as h,Vb as me,Y as a,Yb as ue,Z as n,Zb as pe,_ as d,_b as ge,ca as E,da as u,ea as g,i as te,ma as l,na as y,oa as x,ra as O,sa as U,ta as I,x as P}from"./chunk-WYTV4Y2I.js";import"./chunk-XQESWZ4T.js";import"./chunk-7KGURMOZ.js";import"./chunk-PJL56ILQ.js";import"./chunk-NVWEJ7GR.js";import"./chunk-UVAVEIEI.js";import"./chunk-E6CW6KXY.js";import"./chunk-Z3EESIK6.js";import"./chunk-4U6PRYVA.js";import"./chunk-FXFZIWDD.js";import"./chunk-CSG5OQLY.js";import"./chunk-VMHM3MLJ.js";import"./chunk-6WKZVARI.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{a as ae,h as w}from"./chunk-LNJ3S2LQ.js";function pt(c,b){if(c&1&&(a(0,"ion-item",15)(1,"ion-label",16),l(2," Contrase\xF1a Actual * "),n(),d(3,"ion-input",34),n()),c&2){let r=g();o(3),h("is-invalid",r.hasError("currentPassword"))}}function gt(c,b){if(c&1&&(a(0,"div",35),l(1),n()),c&2){let r=g();o(),x(" ",r.getErrorMessage("currentPassword")," ")}}function bt(c,b){if(c&1&&(a(0,"div",35),l(1),n()),c&2){let r=g();o(),x(" ",r.getErrorMessage("newPassword")," ")}}function ht(c,b){if(c&1&&(a(0,"div",36)(1,"div",37),d(2,"div",38),n(),a(3,"span",39),l(4),n()()),c&2){let r=g();o(),ie("data-strength",r.getPasswordStrength()),o(2),ie("data-strength",r.getPasswordStrength()),o(),x(" Fuerza: ",r.getPasswordStrengthText()," ")}}function ft(c,b){if(c&1&&(a(0,"div",35),l(1),n()),c&2){let r=g();o(),x(" ",r.getErrorMessage("confirmPassword")," ")}}function vt(c,b){c&1&&d(0,"ion-spinner",40)}function wt(c,b){c&1&&d(0,"ion-icon",41)}function _t(c,b){if(c&1&&(a(0,"div",42)(1,"p")(2,"strong"),l(3,"Form Valid:"),n(),l(4),n(),a(5,"p")(6,"strong"),l(7,"Form Errors:"),n(),l(8),n(),a(9,"p")(10,"strong"),l(11,"Is Admin:"),n(),l(12),n()()),c&2){let r=g();o(4),x(" ",r.form.valid,""),o(4),x(" ",r.getFormErrors(),""),o(4),x(" ",r.isAdmin,"")}}var lt=(()=>{let b=class b{constructor(){this.isAdmin=!1,this.formBuilder=P(ue),this.usuariosService=P(ee),this.toastController=P(H),this.loadingController=P(Ee),this.modalController=P(Y),this.alertController=P(K),this.isLoading=_(!1),J({saveOutline:et,closeOutline:Q,keyOutline:X,lockClosedOutline:Ke}),this.form=this.formBuilder.group({currentPassword:[""],newPassword:["",[A.required,A.minLength(6),this.passwordStrengthValidator]],confirmPassword:["",[A.required]]},{validators:this.passwordMatchValidator})}ngOnInit(){let e=this.form.get("currentPassword");this.isAdmin?e==null||e.clearValidators():e==null||e.setValidators([A.required]),e==null||e.updateValueAndValidity()}onSubmit(){return w(this,null,function*(){var e;if(this.markFormGroupTouched(),this.form.valid){if(this.isAdmin&&this.user&&!(yield this.showAdminResetConfirmation()))return;let t=yield this.loadingController.create({message:this.isAdmin?"Restableciendo contrase\xF1a...":"Cambiando contrase\xF1a..."});yield t.present();try{let i=this.form.value;this.isAdmin&&this.user?(yield te(this.usuariosService.changeUserPassword(this.user.id,i.newPassword)),yield this.showToast(`Contrase\xF1a de ${this.user.nombre||this.user.username} restablecida correctamente`,"success")):(yield te(this.usuariosService.changePassword(i.currentPassword,i.newPassword)),yield this.showToast("Su contrase\xF1a ha sido cambiada correctamente","success")),yield this.modalController.dismiss({success:!0})}catch(i){console.error("Error al cambiar contrase\xF1a:",i);let s="Error al cambiar la contrase\xF1a";(i==null?void 0:i.status)===400?s="La contrase\xF1a actual es incorrecta":(i==null?void 0:i.status)===404?s="Usuario no encontrado":(i==null?void 0:i.status)===403?s="No tiene permisos para realizar esta acci\xF3n":(e=i==null?void 0:i.error)!=null&&e.message&&(s=i.error.message),yield this.showToast(s,"danger")}finally{yield t.dismiss()}}else yield this.showToast("Por favor complete todos los campos requeridos","warning")})}passwordStrengthValidator(e){let t=e.value;if(!t)return null;let i=/[0-9]/.test(t),s=/[A-Z]/.test(t),m=/[a-z]/.test(t),C=/[#?!@$%^&*-]/.test(t);return i&&s&&m&&C?null:{passwordStrength:!0}}getPasswordStrength(){var i;let e=(i=this.form.get("newPassword"))==null?void 0:i.value;if(!e)return"none";let t=0;return e.length>=8&&t++,/[0-9]/.test(e)&&t++,/[A-Z]/.test(e)&&t++,/[a-z]/.test(e)&&t++,/[#?!@$%^&*-]/.test(e)&&t++,t<2?"weak":t<4?"medium":"strong"}getPasswordStrengthText(){let e=this.getPasswordStrength();return{none:"",weak:"D\xE9bil",medium:"Moderada",strong:"Fuerte"}[e]}passwordMatchValidator(e){var s;let t=e.get("newPassword"),i=e.get("confirmPassword");if(t!=null&&t.value&&(i!=null&&i.value)&&t.value!==i.value)return i==null||i.setErrors({passwordMismatch:!0}),{passwordMismatch:!0};if((s=i==null?void 0:i.errors)!=null&&s.passwordMismatch){let m=ae({},i.errors);delete m.passwordMismatch,i.setErrors(Object.keys(m).length?m:null)}return null}markFormGroupTouched(){Object.keys(this.form.controls).forEach(e=>{let t=this.form.get(e);t==null||t.markAsTouched()})}hasError(e,t){let i=this.form.get(e);return i?t?i.hasError(t)&&i.touched:i.invalid&&i.touched:!1}getErrorMessage(e){let t=this.form.get(e);if(!t||!t.errors||!t.touched)return"";let i=t.errors;return i.required?`${{currentPassword:"La contrase\xF1a actual",newPassword:"La nueva contrase\xF1a",confirmPassword:"La confirmaci\xF3n de contrase\xF1a"}[e]||"Este campo"} es requerida`:i.minlength?`La contrase\xF1a debe tener al menos ${i.minlength.requiredLength} caracteres`:i.passwordStrength?"La contrase\xF1a debe contener may\xFAsculas, min\xFAsculas, n\xFAmeros y s\xEDmbolos":i.passwordMismatch?"Las contrase\xF1as no coinciden":"Campo inv\xE1lido"}hasUpperCase(){var t;let e=(t=this.form.get("newPassword"))==null?void 0:t.value;return e?/[A-Z]/.test(e):!1}hasLowerCase(){var t;let e=(t=this.form.get("newPassword"))==null?void 0:t.value;return e?/[a-z]/.test(e):!1}hasNumbers(){var t;let e=(t=this.form.get("newPassword"))==null?void 0:t.value;return e?/[0-9]/.test(e):!1}hasSymbols(){var t;let e=(t=this.form.get("newPassword"))==null?void 0:t.value;return e?/[#?!@$%^&*-]/.test(e):!1}hasMinLength(){var t;let e=(t=this.form.get("newPassword"))==null?void 0:t.value;return e?e.length>=8:!1}showAdminResetConfirmation(){return w(this,null,function*(){var i,s;let e=yield this.alertController.create({header:"Confirmar Reset de Contrase\xF1a",message:`\xBFEst\xE1 seguro que desea restablecer la contrase\xF1a de ${((i=this.user)==null?void 0:i.nombre)||((s=this.user)==null?void 0:s.username)}?`,buttons:[{text:"Cancelar",role:"cancel",cssClass:"secondary"},{text:"Confirmar",handler:()=>!0}]});yield e.present();let{role:t}=yield e.onDidDismiss();return t!=="cancel"})}close(){return w(this,null,function*(){yield this.modalController.dismiss({success:!1})})}getFormErrors(){let e=[];return Object.keys(this.form.controls).forEach(t=>{let i=this.form.get(t);i!=null&&i.errors&&e.push(`${t}: ${JSON.stringify(i.errors)}`)}),e.length?e.join(", "):"No errors"}showToast(e,t){return w(this,null,function*(){yield(yield this.toastController.create({message:e,duration:3e3,color:t,position:"top"})).present()})}};b.\u0275fac=function(t){return new(t||b)},b.\u0275cmp=L({type:b,selectors:[["app-change-password"]],inputs:{user:"user",isAdmin:"isAdmin"},decls:55,vars:26,consts:[[1,"municipal-toolbar"],[1,"modal-title"],["slot","end"],["fill","clear",1,"close-btn-modern",3,"click"],["name","close-outline"],[1,"password-change-content"],[1,"p-4"],[3,"ngSubmit","formGroup"],[1,"shadow-sm","mb-4"],[1,"pb-2"],[1,"card-title-modern"],["name","key-outline",1,"title-icon"],[1,"pt-0"],["class","mb-3 rounded-lg custom-input","lines","none",4,"ngIf"],["class","error-message",4,"ngIf"],["lines","none",1,"mb-3","rounded-lg","custom-input"],["position","stacked",1,"input-label-modern"],["formControlName","newPassword","type","password","placeholder","Ingrese la nueva contrase\xF1a",1,"mt-1"],["class","password-strength mt-2",4,"ngIf"],["formControlName","confirmPassword","type","password","placeholder","Confirme la nueva contrase\xF1a",1,"mt-1"],[1,"bg-blue-50","border","border-blue-200","rounded-lg","p-3","mt-4"],[1,"flex","items-start"],["name","lock-closed-outline",1,"text-blue-500","mr-2","mt-1"],[1,"text-sm","text-blue-700"],[1,"font-medium","mb-1"],[1,"list-disc","list-inside","space-y-1","text-xs"],[1,"password-req"],[1,"action-buttons"],["fill","solid",1,"secondary-btn",3,"click"],["name","close-outline","slot","start"],["fill","solid","type","submit",1,"primary-btn",3,"disabled"],["name","crescent","slot","start",4,"ngIf"],["name","save-outline","slot","start",4,"ngIf"],["class","mt-4 p-3 bg-gray-100 rounded text-xs",4,"ngIf"],["formControlName","currentPassword","type","password","placeholder","Ingrese su contrase\xF1a actual",1,"mt-1"],[1,"error-message"],[1,"password-strength","mt-2"],[1,"strength-meter"],[1,"strength-fill"],[1,"strength-text"],["name","crescent","slot","start"],["name","save-outline","slot","start"],[1,"mt-4","p-3","bg-gray-100","rounded","text-xs"]],template:function(t,i){if(t&1&&(a(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title",1),l(3," \u{1F510} Cambiar Contrase\xF1a "),n(),a(4,"ion-buttons",2)(5,"ion-button",3),u("click",function(){return i.close()}),d(6,"ion-icon",4),n()()()(),a(7,"ion-content",5)(8,"div",6)(9,"form",7),u("ngSubmit",function(){return i.onSubmit()}),a(10,"ion-card",8)(11,"ion-card-header",9)(12,"ion-card-title",10),d(13,"ion-icon",11),l(14),n()(),a(15,"ion-card-content",12),k(16,pt,4,2,"ion-item",13)(17,gt,2,1,"div",14),a(18,"ion-item",15)(19,"ion-label",16),l(20," Nueva Contrase\xF1a * "),n(),d(21,"ion-input",17),n(),k(22,bt,2,1,"div",14)(23,ht,5,3,"div",18),a(24,"ion-item",15)(25,"ion-label",16),l(26," Confirmar Nueva Contrase\xF1a * "),n(),d(27,"ion-input",19),n(),k(28,ft,2,1,"div",14),a(29,"div",20)(30,"div",21),d(31,"ion-icon",22),a(32,"div",23)(33,"p",24),l(34,"Requisitos de contrase\xF1a:"),n(),a(35,"ul",25)(36,"li",26),l(37," M\xEDnimo 8 caracteres "),n(),a(38,"li",26),l(39," Al menos una letra may\xFAscula "),n(),a(40,"li",26),l(41," Al menos una letra min\xFAscula "),n(),a(42,"li",26),l(43," Al menos un n\xFAmero "),n(),a(44,"li",26),l(45," Al menos un s\xEDmbolo (especiales) "),n()()()()()()(),a(46,"div",27)(47,"ion-button",28),u("click",function(){return i.close()}),d(48,"ion-icon",29),l(49," Cancelar "),n(),a(50,"ion-button",30),k(51,vt,1,0,"ion-spinner",31)(52,wt,1,0,"ion-icon",32),l(53),n()(),k(54,_t,13,3,"div",33),n()()()),t&2){let s;o(9),p("formGroup",i.form),o(5),x(" ",i.isAdmin?"Restablecer Contrase\xF1a de Usuario":"Cambiar Mi Contrase\xF1a"," "),o(2),p("ngIf",!i.isAdmin),o(),p("ngIf",i.hasError("currentPassword")),o(4),h("is-invalid",i.hasError("newPassword")),o(),p("ngIf",i.hasError("newPassword")),o(),p("ngIf",(s=i.form.get("newPassword"))==null?null:s.value),o(4),h("is-invalid",i.hasError("confirmPassword")),o(),p("ngIf",i.hasError("confirmPassword")),o(8),h("met",i.hasMinLength()),o(2),h("met",i.hasUpperCase()),o(2),h("met",i.hasLowerCase()),o(2),h("met",i.hasNumbers()),o(2),h("met",i.hasSymbols()),o(6),p("disabled",i.form.invalid||i.isLoading()),o(),p("ngIf",i.isLoading()),o(),p("ngIf",!i.isLoading()),o(),x(" ",i.isAdmin?"Restablecer":"Actualizar"," "),o(),p("ngIf",!1)}},dependencies:[V,D,ge,ce,F,se,de,me,B,$,q,W,N,R,Z,be,fe,ve,he,G,ye,Ue,j],styles:['@charset "UTF-8";[_ngcontent-%COMP%]:root{--password-primary: #5ccedf;--password-primary-dark: #38b5c9;--password-danger: #ef4444;--password-dark: #1e293b;--password-medium: #4a5568;--password-text: #2d3748}.municipal-toolbar[_ngcontent-%COMP%]{--background: linear-gradient(135deg, rgba(255, 255, 255, .9) 0%, rgba(244, 244, 245, .9) 100%);--color: #1e293b;position:relative;overflow:hidden;--min-height: 60px}.municipal-toolbar[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(135deg,#ffffff26,#ffffff14);-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);border-bottom:1px solid rgba(229,231,235,.3)}.municipal-toolbar[_ngcontent-%COMP%]   .modal-title[_ngcontent-%COMP%]{position:relative;z-index:2;font-weight:700;font-size:1.4rem;color:#1e293b!important;text-shadow:0 1px 2px rgba(0,0,0,.1);text-align:center;letter-spacing:.025em}.municipal-toolbar[_ngcontent-%COMP%]   .close-btn-modern[_ngcontent-%COMP%]{--background: rgba(255, 255, 255, .8) !important;--color: #64748b !important;--border-radius: 1rem !important;--box-shadow: 0 2px 8px rgba(0, 0, 0, .1) !important;--padding-start: 0 !important;--padding-end: 0 !important;--padding-top: 0 !important;--padding-bottom: 0 !important;width:40px!important;height:40px!important;margin:0!important;border:none!important;position:relative;z-index:2;transition:all .3s cubic-bezier(.4,0,.2,1)}.municipal-toolbar[_ngcontent-%COMP%]   .close-btn-modern[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px}.municipal-toolbar[_ngcontent-%COMP%]   .close-btn-modern[_ngcontent-%COMP%]:hover{--background: rgba(248, 250, 252, .9) !important;--color: #475569 !important;transform:scale(1.05)}ion-content[_ngcontent-%COMP%]{--background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);position:relative}ion-content[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:radial-gradient(circle at 30% 70%,rgba(59,130,246,.1) 0%,transparent 50%),radial-gradient(circle at 70% 30%,rgba(239,68,68,.08) 0%,transparent 50%);pointer-events:none;z-index:0}ion-card[_ngcontent-%COMP%]{--background: rgba(255, 255, 255, .95);--border-radius: 1rem;--box-shadow: 0 4px 20px rgba(92, 206, 223, .15), 0 2px 10px rgba(0, 0, 0, .1);margin:0 0 1.5rem;border:1px solid rgba(92,206,223,.1);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);position:relative;overflow:hidden}ion-card[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(135deg,#fffc,#fff9);pointer-events:none;z-index:0}ion-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]{padding:1.5rem 1.5rem 1rem;position:relative;z-index:1}ion-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]   .card-title-modern[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:700;color:var(--password-dark);display:flex;align-items:center;gap:.75rem;margin:0;text-shadow:0 1px 3px rgba(255,255,255,.8)}ion-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]   .card-title-modern[_ngcontent-%COMP%]   .title-icon[_ngcontent-%COMP%]{font-size:1.5rem;color:var(--password-primary);background:#5ccedf1a;padding:.5rem;border-radius:.75rem;box-shadow:0 2px 8px #5ccedf33}ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{padding:0 1.5rem 1.5rem;position:relative;z-index:1}.custom-input[_ngcontent-%COMP%]{--background: rgba(255, 255, 255, .9);--border-radius: 1rem;--box-shadow: 0 2px 8px rgba(92, 206, 223, .1), 0 4px 16px rgba(0, 0, 0, .08);--padding-start: 1.5rem;--padding-end: 1.5rem;--padding-top: 1rem;--padding-bottom: 1rem;--min-height: 64px;border:2px solid rgba(92,206,223,.2);margin-bottom:.5rem;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);transition:all .3s cubic-bezier(.4,0,.2,1);position:relative;overflow:hidden}.custom-input[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(135deg,#fff9,#ffffff4d);pointer-events:none;z-index:0}.custom-input[_ngcontent-%COMP%]:hover{--background: rgba(255, 255, 255, .95);border-color:#5ccedf66;--box-shadow: 0 4px 16px rgba(92, 206, 223, .15), 0 8px 32px rgba(0, 0, 0, .1);transform:translateY(-2px)}.custom-input[_ngcontent-%COMP%]:focus-within{border-color:var(--password-primary);--box-shadow: 0 4px 20px rgba(92, 206, 223, .3), 0 0 0 3px rgba(92, 206, 223, .1);transform:translateY(-2px)}.custom-input.is-invalid[_ngcontent-%COMP%]{border-color:var(--password-danger);--background: rgba(239, 68, 68, .05);--box-shadow: 0 2px 8px rgba(239, 68, 68, .2)}.custom-input[_ngcontent-%COMP%]   .input-label-modern[_ngcontent-%COMP%]{font-size:.875rem;font-weight:600;color:var(--password-dark);margin-bottom:.5rem;position:relative;z-index:1;text-shadow:0 1px 2px rgba(255,255,255,.8)}.custom-input[_ngcontent-%COMP%]   .input-label-modern[position=stacked][_ngcontent-%COMP%]{transform:none;font-size:.875rem;margin-bottom:.75rem}.custom-input[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{--color: var(--password-dark);--placeholder-color: var(--password-medium);font-size:1rem;font-weight:500;position:relative;z-index:1}.custom-input[_ngcontent-%COMP%]   ion-input.is-invalid[_ngcontent-%COMP%]{--color: var(--password-danger)}.error-message[_ngcontent-%COMP%]{color:var(--ion-color-danger);font-size:12px;margin-bottom:16px;margin-left:12px;font-weight:500}.password-strength[_ngcontent-%COMP%]{margin-top:8px}.password-strength[_ngcontent-%COMP%]   .strength-meter[_ngcontent-%COMP%]{width:100%;height:4px;background-color:#e9ecef;border-radius:2px;overflow:hidden;margin-bottom:4px}.password-strength[_ngcontent-%COMP%]   .strength-meter[_ngcontent-%COMP%]   .strength-fill[_ngcontent-%COMP%]{height:100%;width:0%;transition:all .3s ease;border-radius:2px}.password-strength[_ngcontent-%COMP%]   .strength-meter[data-strength=weak][_ngcontent-%COMP%]   .strength-fill[_ngcontent-%COMP%]{width:33%;background-color:#dc3545}.password-strength[_ngcontent-%COMP%]   .strength-meter[data-strength=medium][_ngcontent-%COMP%]   .strength-fill[_ngcontent-%COMP%]{width:66%;background-color:#ffc107}.password-strength[_ngcontent-%COMP%]   .strength-meter[data-strength=strong][_ngcontent-%COMP%]   .strength-fill[_ngcontent-%COMP%]{width:100%;background-color:#28a745}.password-strength[_ngcontent-%COMP%]   .strength-text[_ngcontent-%COMP%]{font-size:11px;font-weight:500}.password-strength[_ngcontent-%COMP%]   .strength-text[data-strength=weak][_ngcontent-%COMP%]{color:#dc3545}.password-strength[_ngcontent-%COMP%]   .strength-text[data-strength=medium][_ngcontent-%COMP%]{color:#ffc107}.password-strength[_ngcontent-%COMP%]   .strength-text[data-strength=strong][_ngcontent-%COMP%]{color:#28a745}.password-req[_ngcontent-%COMP%]{transition:color .3s ease}.password-req.met[_ngcontent-%COMP%]{color:#28a745!important;font-weight:500}.password-req.met[_ngcontent-%COMP%]:before{content:"\\2713  ";color:#28a745;font-weight:700}.password-req[_ngcontent-%COMP%]:not(.met):before{content:"\\25cb  ";color:#6c757d}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:1rem;padding:1.5rem;background:#f9fafbcc;border-radius:0 0 1rem 1rem;border-top:1px solid rgba(229,231,235,.5)}.action-buttons[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{flex:1;height:48px;--border-radius: 1rem !important;border:none!important;font-weight:600;text-transform:none}.action-buttons[_ngcontent-%COMP%]   ion-button.secondary-btn[_ngcontent-%COMP%]{--background: rgba(248, 250, 252, .9) !important;--color: #64748b !important;--box-shadow: 0 2px 4px rgba(0, 0, 0, .1) !important}.action-buttons[_ngcontent-%COMP%]   ion-button.secondary-btn[_ngcontent-%COMP%]:hover{--background: rgba(241, 245, 249, .95) !important;--color: #475569 !important}.action-buttons[_ngcontent-%COMP%]   ion-button.primary-btn[_ngcontent-%COMP%]{--background: linear-gradient(135deg, #5ccedf 0%, #38b5c9 100%) !important;--color: white !important;--box-shadow: 0 4px 12px rgba(92, 206, 223, .3) !important}.action-buttons[_ngcontent-%COMP%]   ion-button.primary-btn[_ngcontent-%COMP%]:hover{--background: linear-gradient(135deg, #38b5c9 0%, #2a9fb5 100%) !important}.action-buttons[_ngcontent-%COMP%]   ion-button.primary-btn[_ngcontent-%COMP%]:disabled{--background: rgba(156, 163, 175, .6) !important;--color: rgba(255, 255, 255, .7) !important;--box-shadow: none !important}.action-buttons[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-right:.5rem}.action-buttons[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]   ion-spinner[_ngcontent-%COMP%]{margin-right:.5rem}@media (max-width: 768px){.municipal-toolbar[_ngcontent-%COMP%]{--min-height: 56px}.municipal-toolbar[_ngcontent-%COMP%]   .modal-title[_ngcontent-%COMP%]{font-size:1.2rem}.municipal-toolbar[_ngcontent-%COMP%]   .close-btn-modern[_ngcontent-%COMP%]{width:36px!important;height:36px!important}.municipal-toolbar[_ngcontent-%COMP%]   .close-btn-modern[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}ion-card[_ngcontent-%COMP%]{--border-radius: .75rem;margin:0 0 1rem}ion-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]{padding:1rem 1rem .5rem}ion-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]   .card-title-modern[_ngcontent-%COMP%]{font-size:1.1rem}ion-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]   .card-title-modern[_ngcontent-%COMP%]   .title-icon[_ngcontent-%COMP%]{font-size:1.25rem;padding:.4rem}ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{padding:0 1rem 1rem}.custom-input[_ngcontent-%COMP%]{--padding-start: 1rem;--padding-end: 1rem;--padding-top: .75rem;--padding-bottom: .75rem;--min-height: 56px}.custom-input[_ngcontent-%COMP%]   .input-label-modern[_ngcontent-%COMP%]{font-size:.8rem}.custom-input[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{font-size:.9rem}.action-buttons[_ngcontent-%COMP%]{flex-direction:column;gap:.75rem;padding:1rem}.action-buttons[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{height:44px;font-size:.9rem}.action-buttons[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .action-buttons[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]   ion-spinner[_ngcontent-%COMP%]{font-size:1.1rem}.error-message[_ngcontent-%COMP%]{font-size:.75rem;margin-left:.75rem}}']});let c=b;return c})();function xt(c,b){if(c&1&&(a(0,"ion-select-option",25),l(1),n()),c&2){let r=b.$implicit;p("value",r),o(),y(r)}}function kt(c,b){if(c&1){let r=E();a(0,"ion-item",22)(1,"ion-select",39),I("ngModelChange",function(t){f(r);let i=g();return U(i.selectedGerencia,t)||(i.selectedGerencia=t),v(t)}),u("ionChange",function(t){f(r);let i=g();return v(i.onGerenciaChange(t))}),a(2,"ion-select-option",24),l(3,"Todas las gerencias"),n(),k(4,xt,2,2,"ion-select-option",40),n()()}if(c&2){let r=g();o(),O("ngModel",r.selectedGerencia),o(3),p("ngForOf",r.availableGerencias())}}function yt(c,b){c&1&&(a(0,"div",41),d(1,"ion-spinner",42),a(2,"p"),l(3,"Cargando usuarios..."),n()())}function Ct(c,b){if(c&1){let r=E();a(0,"div",65)(1,"div",66),d(2,"ion-icon",67),a(3,"span"),l(4),n()(),a(5,"div",68)(6,"ion-button",69),u("click",function(){f(r);let t=g(2);return v(t.bulkActivateUsers())}),d(7,"ion-icon",70),l(8," Activar "),n(),a(9,"ion-button",71),u("click",function(){f(r);let t=g(2);return v(t.bulkDeactivateUsers())}),d(10,"ion-icon",72),l(11," Desactivar "),n(),a(12,"ion-button",73),u("click",function(){f(r);let t=g(2);return v(t.bulkExportUsers())}),d(13,"ion-icon",74),l(14," Exportar "),n(),a(15,"ion-button",75),u("click",function(){f(r);let t=g(2);return v(t.clearSelection())}),d(16,"ion-icon",76),l(17," Limpiar "),n()()()}if(c&2){let r=g(2);o(4),x("",r.selectedUsers().size," usuario(s) seleccionado(s)"),o(2),p("disabled",r.bulkActionsLoading()),o(3),p("disabled",r.bulkActionsLoading()),o(3),p("disabled",r.bulkActionsLoading())}}function Pt(c,b){if(c&1){let r=E();a(0,"div",77),u("click",function(t){let i=f(r).$implicit,s=g(2);return v(s.onRowClick(i,t))}),a(1,"div",78),u("click",function(t){return f(r),v(t.stopPropagation())}),a(2,"ion-checkbox",79),u("ionChange",function(t){let i=f(r).$implicit,s=g(2);return v(s.toggleUserSelection(i,t))}),n()(),a(3,"div",80)(4,"div",81)(5,"div",82),l(6),n(),a(7,"div",83)(8,"div",84),l(9),n(),a(10,"div",85),l(11),n()()()(),a(12,"div",86)(13,"span",87),l(14),n()(),a(15,"div",88)(16,"span",87),l(17),n()(),a(18,"div",89)(19,"div",90),l(20),n()(),a(21,"div",91)(22,"div",92),d(23,"div",93),a(24,"span"),l(25),n()()(),a(26,"div",94)(27,"span",87),l(28),n()(),a(29,"div",95),u("click",function(t){return f(r),v(t.stopPropagation())}),a(30,"div",96)(31,"button",97),u("click",function(){let t=f(r).$implicit,i=g(2);return v(i.viewUser(t))}),d(32,"ion-icon",98),n(),a(33,"button",99),u("click",function(){let t=f(r).$implicit,i=g(2);return v(i.editUser(t))}),d(34,"ion-icon",100),n(),a(35,"button",101),u("click",function(){let t=f(r).$implicit,i=g(2);return v(i.resetPassword(t))}),d(36,"ion-icon",102),n(),a(37,"button",103),u("click",function(){let t=f(r).$implicit,i=g(2);return v(i.toggleUserStatus(t))}),d(38,"ion-icon",104),n()()()()}if(c&2){let r=b.$implicit,e=g(2);h("inactive",!r.isActive)("selected",e.isUserSelected(r))("loading",e.userActionLoading().has(r.id)),o(2),p("checked",e.isUserSelected(r)),o(4),x(" ",e.getAvatarInitials(r)," "),o(3),y(e.getFullName(r)),o(2),y(r.username),o(3),y(r.correo||r.email||"-"),o(3),y(r.telefono||r.phone||"-"),o(2),h("admin",r.role===e.Role.ADMIN)("market",r.role===e.Role.MARKET)("user",r.role===e.Role.USER),o(),x(" ",e.getRoleText(r.role)," "),o(2),h("inactive",!r.isActive),o(3),y(e.getUserStatus(r).text),o(3),y(e.formatLastLogin(r.lastLogin)),o(9),h("deactivate",r.isActive)("activate",!r.isActive),p("title",r.isActive?"Desactivar usuario":"Activar usuario"),o(),p("name",r.isActive?"close-circle-outline":"checkmark-circle-outline")}}function St(c,b){if(c&1&&(a(0,"div",110)(1,"span",111),l(2,"Tel\xE9fono:"),n(),a(3,"span",118),l(4),n()()),c&2){let r=g().$implicit;o(4),y(r.telefono||r.phone)}}function Mt(c,b){if(c&1){let r=E();a(0,"div",105),u("click",function(){let t=f(r).$implicit,i=g(2);return v(i.viewUser(t))}),a(1,"div",106)(2,"div",81)(3,"div",82),l(4),n(),a(5,"div",83)(6,"div",84),l(7),n(),a(8,"div",107),l(9),n()()(),a(10,"div",108)(11,"div",92),d(12,"div",93),n()()(),a(13,"div",109)(14,"div",110)(15,"span",111),l(16,"Rol:"),n(),a(17,"div",112),l(18),n()(),k(19,St,5,1,"div",113),n(),a(20,"div",114),u("click",function(t){return f(r),v(t.stopPropagation())}),a(21,"button",115),u("click",function(){let t=f(r).$implicit,i=g(2);return v(i.editUser(t))}),d(22,"ion-icon",100),n(),a(23,"button",116),u("click",function(){let t=f(r).$implicit,i=g(2);return v(i.resetPassword(t))}),d(24,"ion-icon",102),n(),a(25,"button",117),u("click",function(){let t=f(r).$implicit,i=g(2);return v(i.toggleUserStatus(t))}),d(26,"ion-icon",104),n()()()}if(c&2){let r=b.$implicit,e=g(2);h("inactive",!r.isActive),o(4),x(" ",e.getAvatarInitials(r)," "),o(3),y(e.getFullName(r)),o(2),y(r.correo||r.email),o(2),h("inactive",!r.isActive),o(6),h("admin",r.role===e.Role.ADMIN)("market",r.role===e.Role.MARKET)("user",r.role===e.Role.USER),o(),x(" ",e.getRoleText(r.role)," "),o(),p("ngIf",r.telefono||r.phone),o(6),h("deactivate",r.isActive)("activate",!r.isActive),o(),p("name",r.isActive?"close-circle-outline":"checkmark-circle-outline")}}function Et(c,b){if(c&1){let r=E();a(0,"div",119),d(1,"ion-icon",120),a(2,"h3"),l(3,"\u{1F614} No se encontraron usuarios"),n(),a(4,"p"),l(5,"No hay usuarios que coincidan con los filtros seleccionados."),n(),a(6,"ion-button",121),u("click",function(){f(r);let t=g(2);return v(t.clearFilters())}),d(7,"ion-icon",122),l(8," Limpiar filtros "),n()()}}function Ot(c,b){if(c&1){let r=E();a(0,"div",43)(1,"div",44)(2,"div",45),k(3,Ct,18,4,"div",46),a(4,"div",47)(5,"div",48)(6,"ion-checkbox",49),I("ngModelChange",function(t){f(r);let i=g();return U(i.selectAll,t)||(i.selectAll=t),v(t)}),u("ionChange",function(t){f(r);let i=g();return v(i.toggleSelectAll(t))}),n()(),a(7,"div",50),u("click",function(){f(r);let t=g();return v(t.sortBy("name"))}),a(8,"span"),l(9,"Usuario"),n(),a(10,"div",51),d(11,"ion-icon",52)(12,"ion-icon",53),n()(),a(13,"div",54),u("click",function(){f(r);let t=g();return v(t.sortBy("email"))}),a(14,"span"),l(15,"Email"),n(),a(16,"div",51),d(17,"ion-icon",52)(18,"ion-icon",53),n()(),a(19,"div",55),l(20,"Tel\xE9fono"),n(),a(21,"div",56),u("click",function(){f(r);let t=g();return v(t.sortBy("role"))}),a(22,"span"),l(23,"Rol"),n(),a(24,"div",51),d(25,"ion-icon",52)(26,"ion-icon",53),n()(),a(27,"div",57),u("click",function(){f(r);let t=g();return v(t.sortBy("status"))}),a(28,"span"),l(29,"Estado"),n(),a(30,"div",51),d(31,"ion-icon",52)(32,"ion-icon",53),n()(),a(33,"div",58),u("click",function(){f(r);let t=g();return v(t.sortBy("lastLogin"))}),a(34,"span"),l(35,"\xDAltimo Acceso"),n(),a(36,"div",51),d(37,"ion-icon",52)(38,"ion-icon",53),n()(),a(39,"div",59),l(40,"Acciones"),n()(),a(41,"div",60),k(42,Pt,39,29,"div",61),n()()(),a(43,"div",62),k(44,Mt,27,20,"div",63),n(),k(45,Et,9,0,"div",64),n()}if(c&2){let r=g();o(3),p("ngIf",r.selectedUsers().size>0),o(3),O("ngModel",r.selectAll),p("indeterminate",r.isIndeterminate()),o(),h("active",r.currentSort().field==="name"),o(4),h("active",r.currentSort().field==="name"&&r.currentSort().direction==="asc"),o(),h("active",r.currentSort().field==="name"&&r.currentSort().direction==="desc"),o(),h("active",r.currentSort().field==="email"),o(4),h("active",r.currentSort().field==="email"&&r.currentSort().direction==="asc"),o(),h("active",r.currentSort().field==="email"&&r.currentSort().direction==="desc"),o(3),h("active",r.currentSort().field==="role"),o(4),h("active",r.currentSort().field==="role"&&r.currentSort().direction==="asc"),o(),h("active",r.currentSort().field==="role"&&r.currentSort().direction==="desc"),o(),h("active",r.currentSort().field==="status"),o(4),h("active",r.currentSort().field==="status"&&r.currentSort().direction==="asc"),o(),h("active",r.currentSort().field==="status"&&r.currentSort().direction==="desc"),o(),h("active",r.currentSort().field==="lastLogin"),o(4),h("active",r.currentSort().field==="lastLogin"&&r.currentSort().direction==="asc"),o(),h("active",r.currentSort().field==="lastLogin"&&r.currentSort().direction==="desc"),o(4),p("ngForOf",r.usuarios())("ngForTrackBy",r.trackByUser),o(2),p("ngForOf",r.usuarios())("ngForTrackBy",r.trackByUser),o(),p("ngIf",r.usuarios().length===0)}}var ei=(()=>{let b=class b{getInitials(e){return e?e.split(" ").map(t=>t.charAt(0)).slice(0,2).join("").toUpperCase():"?"}getFullName(e){return e.nombre&&e.apellido?`${e.nombre} ${e.apellido}`.trim():e.username||e.nombre||e.apellido||"Usuario"}getAvatarInitials(e){return this.getInitials(this.getFullName(e))}getRoleText(e){return this.getRoleDisplayName(e)}getUserStatus(e){return{text:e.isActive?"Activo":"Inactivo",class:e.isActive?"active":"inactive"}}formatLastLogin(e){if(!e)return"Nunca";let t;return typeof e=="string"?t=new Date(e):t=e,isNaN(t.getTime())?"Nunca":t.toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}trackByUser(e,t){return t.id||t.username||e}formatDate(e){if(!e)return"Nunca";let t;return typeof e=="string"?t=new Date(e):t=e,isNaN(t.getTime())?"Nunca":t.toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"})}formatDateTime(e){if(!e)return"Nunca";let t;return typeof e=="string"?t=new Date(e):t=e,isNaN(t.getTime())?"Nunca":t.toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}getRoleDisplayName(e){return{[T.ADMIN]:"Administrador",[T.MARKET]:"Mercado",[T.USER]:"Usuario"}[e]||e}getStatusText(e){return e?"Activo":"Inactivo"}getActiveUsersCount(){return this.usuarios().filter(e=>e.isActive).length}getInactiveUsersCount(){return this.usuarios().filter(e=>!e.isActive).length}getAdminUsersCount(){return this.usuarios().filter(e=>e.role===T.ADMIN).length}constructor(){this.usuariosService=P(ee),this.router=P(oe),this.alertController=P(K),this.toastController=P(H),this.modalController=P(Y),this.usuarios=_([]),this.loading=_(!1),this.searchTerm=_(""),this.currentPage=_(1),this.totalPages=_(0),this.totalItems=_(0),this.selectedRole=_(""),this.selectedStatus=_(""),this.selectedGerencia=_(""),this.userStats=_(null),this.selectedUsers=_(new Set),this.selectAll=_(!1),this.currentSort=_({field:"name",direction:"asc"}),this.bulkActionsLoading=_(!1),this.userActionLoading=_(new Set),this.filteredByRole=z(()=>e=>this.usuarios().filter(t=>t.role===e)),this.filteredByStatus=z(()=>e=>this.usuarios().filter(t=>t.isActive===e)),this.availableGerencias=z(()=>this.usuarios().map(t=>t.gerencia).filter(t=>t&&t.trim()).filter((t,i,s)=>s.indexOf(t)===i).sort()),this.Role=T,J({addOutline:Ae,peopleOutline:Ze,checkmarkCircleOutline:Re,closeCircleOutline:$e,shieldOutline:it,refreshOutline:Xe,checkmarkCircle:Fe,downloadOutline:je,closeOutline:Q,chevronUpOutline:Be,chevronDownOutline:Ne,eyeOutline:We,createOutline:Ge,keyOutline:X,radioButtonOnOutline:Qe,mailOutline:He,callOutline:De,atOutline:Le,cardOutline:Ve,businessOutline:ze,personOutline:Je,timeOutline:at,searchOutline:tt,trashOutline:ot,filterOutline:Ye,ellipsisVerticalOutline:qe,statsChartOutline:rt,toggleOutline:nt,warningOutline:st})}ngOnInit(){this.loadUsuarios(),this.loadUserStats()}loadUsuarios(e=!1){return w(this,null,function*(){this.loading.set(!0);let t={page:e?1:this.currentPage(),limit:12};this.searchTerm()&&(t.search=this.searchTerm()),this.selectedRole()&&(t.role=this.selectedRole()),this.selectedStatus()!==""&&(t.isActive=this.selectedStatus()),this.selectedGerencia()&&(t.gerencia=this.selectedGerencia());try{let i=yield this.usuariosService.getUsers(t.page||1,t.limit||12,t).toPromise();i&&(this.usuarios.set(i.data),this.totalPages.set(i.pagination.total_pages),this.totalItems.set(i.pagination.total),this.currentPage.set(i.pagination.current_page))}catch(i){console.error("Error loading usuarios:",i),yield this.showToast("Error al cargar usuarios","danger")}finally{this.loading.set(!1)}})}loadUserStats(){return w(this,null,function*(){try{let e=yield this.usuariosService.getUserStats().toPromise();this.userStats.set(e)}catch(e){console.error("Error loading user stats:",e)}})}onSearch(e){this.searchTerm.set(e.target.value),this.currentPage.set(1),this.loadUsuarios(!0)}onRoleChange(e){this.selectedRole.set(e.detail.value),this.currentPage.set(1),this.loadUsuarios(!0)}onStatusChange(e){this.selectedStatus.set(e.detail.value),this.currentPage.set(1),this.loadUsuarios(!0)}onGerenciaChange(e){this.selectedGerencia.set(e.detail.value),this.currentPage.set(1),this.loadUsuarios(!0)}doRefresh(e){return w(this,null,function*(){yield this.loadUsuarios(!0),yield this.loadUserStats(),e.target.complete()})}loadMore(e){return w(this,null,function*(){if(this.currentPage()<this.totalPages()){this.currentPage.update(i=>i+1);let t={page:this.currentPage(),limit:12};this.searchTerm()&&(t.search=this.searchTerm()),this.selectedRole()&&(t.role=this.selectedRole()),this.selectedStatus()!==""&&(t.isActive=this.selectedStatus()),this.selectedGerencia()&&(t.gerencia=this.selectedGerencia());try{let i=yield this.usuariosService.getUsers(t.page||1,t.limit||12,t).toPromise();if(i){let s=this.usuarios();this.usuarios.set([...s,...i.data]),this.totalPages.set(i.pagination.total_pages)}}catch(i){console.error("Error loading more usuarios:",i)}}e.target.complete()})}viewUser(e){this.router.navigate(["/usuarios",e.id])}createUser(){return w(this,null,function*(){let e=yield this.modalController.create({component:re,componentProps:{isEdit:!1}});e.onDidDismiss().then(t=>{var i;(i=t.data)!=null&&i.success&&(this.loadUsuarios(!0),this.loadUserStats(),this.showToast("Usuario creado correctamente","success"))}),yield e.present()})}editUser(e){return w(this,null,function*(){let t=yield this.modalController.create({component:re,componentProps:{isEdit:!0,user:e}});t.onDidDismiss().then(i=>{var s;(s=i.data)!=null&&s.success&&(this.loadUsuarios(!0),this.loadUserStats(),this.showToast("Usuario actualizado correctamente","success"))}),yield t.present()})}toggleUserStatus(e){return w(this,null,function*(){let t=!e.isActive,i=t?"activar":"desactivar";yield(yield this.alertController.create({header:`${i.charAt(0).toUpperCase()+i.slice(1)} usuario`,message:`\xBFEst\xE1s seguro de ${i} al usuario ${this.getFullName(e)}?`,buttons:[{text:"Cancelar",role:"cancel"},{text:i.charAt(0).toUpperCase()+i.slice(1),handler:()=>w(this,null,function*(){try{yield this.usuariosService.toggleUserStatus(e.id,t).toPromise(),yield this.showToast(`Usuario ${i==="activar"?"activado":"desactivado"} correctamente`,"success"),yield this.loadUsuarios(!0),yield this.loadUserStats()}catch{yield this.showToast(`Error al ${i} usuario`,"danger")}})}]})).present()})}resetPassword(e){return w(this,null,function*(){let t=yield this.modalController.create({component:lt,componentProps:{user:e,isAdmin:!0}});t.onDidDismiss().then(i=>{var s;(s=i.data)!=null&&s.success&&this.showToast("Contrase\xF1a restablecida correctamente","success")}),yield t.present()})}deleteUser(e){return w(this,null,function*(){yield(yield this.alertController.create({header:"Eliminar usuario",message:`\xBFEst\xE1s seguro de eliminar al usuario ${this.getFullName(e)}? Esta acci\xF3n no se puede deshacer.`,buttons:[{text:"Cancelar",role:"cancel"},{text:"Eliminar",role:"destructive",handler:()=>w(this,null,function*(){try{yield this.usuariosService.deleteUser(e.id).toPromise(),yield this.showToast("Usuario eliminado correctamente","success"),yield this.loadUsuarios(!0)}catch(i){console.error("Error al eliminar usuario:",i),yield this.showToast("Error al eliminar usuario","danger")}})}]})).present()})}isUserSelected(e){return this.selectedUsers().has(e.id)}toggleUserSelection(e,t){let i=new Set(this.selectedUsers());t.detail.checked?i.add(e.id):i.delete(e.id),this.selectedUsers.set(i),this.updateSelectAllState()}toggleSelectAll(e){let t=new Set;e.detail.checked&&this.usuarios().forEach(i=>t.add(i.id)),this.selectedUsers.set(t),this.selectAll.set(e.detail.checked)}isIndeterminate(){let e=this.selectedUsers().size,t=this.usuarios().length;return e>0&&e<t}updateSelectAllState(){let e=this.selectedUsers().size,t=this.usuarios().length;e===0?this.selectAll.set(!1):e===t&&this.selectAll.set(!0)}clearSelection(){this.selectedUsers.set(new Set),this.selectAll.set(!1)}onRowClick(e,t){if(this.selectedUsers().size===0)this.viewUser(e);else{let i=new Set(this.selectedUsers());i.has(e.id)?i.delete(e.id):i.add(e.id),this.selectedUsers.set(i),this.updateSelectAllState()}}sortBy(e){let t=this.currentSort(),i="asc";t.field===e&&(i=t.direction==="asc"?"desc":"asc"),this.currentSort.set({field:e,direction:i}),this.applySorting()}applySorting(){let{field:e,direction:t}=this.currentSort(),i=[...this.usuarios()].sort((s,m)=>{let C,S;switch(e){case"name":C=this.getFullName(s).toLowerCase(),S=this.getFullName(m).toLowerCase();break;case"email":C=(s.correo||s.email||"").toLowerCase(),S=(m.correo||m.email||"").toLowerCase();break;case"role":C=s.role,S=m.role;break;case"status":C=s.isActive?1:0,S=m.isActive?1:0;break;case"lastLogin":C=s.lastLogin?new Date(s.lastLogin).getTime():0,S=m.lastLogin?new Date(m.lastLogin).getTime():0;break;default:C="",S=""}return C<S?t==="asc"?-1:1:C>S?t==="asc"?1:-1:0});this.usuarios.set(i)}bulkActivateUsers(){return w(this,null,function*(){if(this.selectedUsers().size===0)return;yield(yield this.alertController.create({header:"Activar usuarios",message:`\xBFActivar ${this.selectedUsers().size} usuario(s) seleccionado(s)?`,buttons:[{text:"Cancelar",role:"cancel"},{text:"Activar",handler:()=>this.executeBulkAction("activate")}]})).present()})}bulkDeactivateUsers(){return w(this,null,function*(){if(this.selectedUsers().size===0)return;yield(yield this.alertController.create({header:"Desactivar usuarios",message:`\xBFDesactivar ${this.selectedUsers().size} usuario(s) seleccionado(s)?`,buttons:[{text:"Cancelar",role:"cancel"},{text:"Desactivar",handler:()=>this.executeBulkAction("deactivate")}]})).present()})}bulkExportUsers(){return w(this,null,function*(){if(this.selectedUsers().size!==0)try{this.bulkActionsLoading.set(!0);let e=this.usuarios().filter(i=>this.selectedUsers().has(i.id)),t=this.createCSV(e);this.downloadCSV(t,`usuarios_seleccionados_${new Date().toISOString().split("T")[0]}.csv`),yield this.showToast(`${e.length} usuarios exportados correctamente`,"success"),this.clearSelection()}catch(e){console.error("Error al exportar usuarios:",e),yield this.showToast("Error al exportar usuarios","danger")}finally{this.bulkActionsLoading.set(!1)}})}executeBulkAction(e){return w(this,null,function*(){try{this.bulkActionsLoading.set(!0);let t=Array.from(this.selectedUsers()),i=e==="activate",s=t.map(M=>w(this,null,function*(){try{return yield this.usuariosService.updateUserStatus(M,i).toPromise(),{success:!0,userId:M}}catch(ct){return{success:!1,userId:M,error:ct}}})),m=yield Promise.all(s),C=m.filter(M=>M.success),S=m.filter(M=>!M.success);C.length>0&&(yield this.showToast(`${C.length} usuario(s) ${e==="activate"?"activado(s)":"desactivado(s)"} correctamente`,"success")),S.length>0&&(yield this.showToast(`Error al procesar ${S.length} usuario(s)`,"warning")),this.clearSelection(),yield this.loadUsuarios(!0)}catch(t){console.error("Error en acci\xF3n en lote:",t),yield this.showToast("Error al procesar la acci\xF3n","danger")}finally{this.bulkActionsLoading.set(!1)}})}createCSV(e){let t=["Nombre","Usuario","Email","Tel\xE9fono","Rol","Estado","\xDAltimo Acceso","Gerencia"],i=e.map(s=>[this.getFullName(s),s.username,s.correo||s.email||"",s.telefono||s.phone||"",this.getRoleDisplayName(s.role),s.isActive?"Activo":"Inactivo",this.formatLastLogin(s.lastLogin),s.gerencia||""]);return[t,...i].map(s=>s.map(m=>`"${m}"`).join(",")).join(`
`)}downloadCSV(e,t){let i=new Blob([e],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a");if(s.download!==void 0){let m=URL.createObjectURL(i);s.setAttribute("href",m),s.setAttribute("download",t),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s)}}clearFilters(){this.searchTerm.set(""),this.selectedRole.set(""),this.selectedStatus.set(""),this.selectedGerencia.set(""),this.currentPage.set(1),this.loadUsuarios(!0)}showToast(e,t="success"){return w(this,null,function*(){yield(yield this.toastController.create({message:e,duration:3e3,color:t,position:"top"})).present()})}};b.\u0275fac=function(t){return new(t||b)},b.\u0275cmp=L({type:b,selectors:[["app-usuarios-list"]],decls:79,vars:18,consts:[[3,"translucent"],["slot","start"],["slot","end"],["fill","clear",3,"click"],["name","add-outline"],[1,"users-page",3,"fullscreen"],[1,"sticky-header"],[1,"header-stats"],[1,"stats-cards"],[1,"stat-item",3,"click"],["name","people-outline"],[1,"stat-number"],[1,"stat-label"],[1,"stat-item","success",3,"click"],["name","checkmark-circle-outline"],[1,"stat-item","pending",3,"click"],["name","close-circle-outline"],[1,"stat-item","admin",3,"click"],["name","shield-outline"],[1,"search-filters"],["placeholder","\u{1F50D} Buscar por nombre, email, usuario...","debounce","500","show-clear-button","focus",3,"ngModelChange","ionInput","ngModel"],[1,"filters-row"],[1,"filter-item"],["placeholder","\u{1F465} Filtrar por Rol","interface","popover",3,"ngModelChange","ionChange","ngModel"],["value",""],[3,"value"],["placeholder","\u26A1 Filtrar por Estado","interface","popover",3,"ngModelChange","ionChange","ngModel"],["class","filter-item",4,"ngIf"],["fill","clear","title","Limpiar todos los filtros",1,"clear-filters-btn",3,"click"],["name","refresh-outline"],[1,"main-content"],["slot","fixed",3,"ionRefresh"],["pulling-icon","chevron-down-circle-outline","pulling-text","Desliza para actualizar","refreshing-spinner","circles","refreshing-text","Actualizando..."],["class","loading-container",4,"ngIf"],["class","users-content",4,"ngIf"],["threshold","100px",3,"ionInfinite","disabled"],["loading-spinner","bubbles","loading-text","Cargando m\xE1s usuarios..."],["vertical","bottom","horizontal","end","slot","fixed"],["color","primary","title","Crear nuevo usuario",3,"click"],["placeholder","\u{1F3E2} Filtrar por Gerencia","interface","popover",3,"ngModelChange","ionChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"loading-container"],["name","crescent","color","primary"],[1,"users-content"],[1,"desktop-table"],[1,"modern-table-wrapper"],["class","table-toolbar",4,"ngIf"],[1,"table-header"],[1,"header-cell","select-col"],[1,"select-all-checkbox",3,"ngModelChange","ionChange","ngModel","indeterminate"],[1,"header-cell","sortable-header","user-col",3,"click"],[1,"sort-indicators"],["name","chevron-up-outline",1,"sort-icon"],["name","chevron-down-outline",1,"sort-icon"],[1,"header-cell","sortable-header","email-col",3,"click"],[1,"header-cell","phone-col"],[1,"header-cell","sortable-header","role-col",3,"click"],[1,"header-cell","sortable-header","status-col",3,"click"],[1,"header-cell","sortable-header","access-col",3,"click"],[1,"header-cell","actions-col"],[1,"table-body"],["class","table-row",3,"inactive","selected","loading","click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"mobile-cards"],["class","user-card",3,"inactive","click",4,"ngFor","ngForOf","ngForTrackBy"],["class","empty-state",4,"ngIf"],[1,"table-toolbar"],[1,"selection-info"],["name","checkmark-circle","color","light"],[1,"bulk-actions"],["fill","outline","size","small","color","light","title","Activar usuarios seleccionados",3,"click","disabled"],["name","checkmark-circle-outline","slot","start"],["fill","outline","size","small","color","light","title","Desactivar usuarios seleccionados",3,"click","disabled"],["name","close-circle-outline","slot","start"],["fill","outline","size","small","color","light","title","Exportar usuarios seleccionados",3,"click","disabled"],["name","download-outline","slot","start"],["fill","clear","size","small","color","light","title","Limpiar selecci\xF3n",3,"click"],["name","close-outline","slot","start"],[1,"table-row",3,"click"],[1,"table-cell","select-col",3,"click"],[1,"row-checkbox",3,"ionChange","checked"],[1,"table-cell","user-col"],[1,"user-info"],[1,"user-avatar"],[1,"user-details"],[1,"user-name"],[1,"user-username"],[1,"table-cell","email-col"],[1,"cell-text"],[1,"table-cell","phone-col"],[1,"table-cell","role-col"],[1,"role-badge"],[1,"table-cell","status-col"],[1,"status-badge"],[1,"status-dot"],[1,"table-cell","access-col"],[1,"table-cell","actions-col",3,"click"],[1,"action-buttons"],["title","Ver detalles",1,"action-btn","view-btn",3,"click"],["name","eye-outline"],["title","Editar usuario",1,"action-btn","edit-btn",3,"click"],["name","create-outline"],["title","Cambiar contrase\xF1a",1,"action-btn","password-btn",3,"click"],["name","key-outline"],[1,"action-btn","toggle-btn",3,"click","title"],[3,"name"],[1,"user-card",3,"click"],[1,"card-header"],[1,"user-email"],[1,"user-status"],[1,"card-content"],[1,"info-row"],[1,"label"],[1,"role-badge","mobile"],["class","info-row",4,"ngIf"],[1,"card-actions",3,"click"],[1,"mobile-action-btn","edit",3,"click"],[1,"mobile-action-btn","password",3,"click"],[1,"mobile-action-btn","toggle",3,"click"],[1,"value"],[1,"empty-state"],["name","people-outline","size","large"],["fill","outline",3,"click"],["name","refresh-outline","slot","start"]],template:function(t,i){t&1&&(a(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),d(3,"ion-menu-button"),n(),a(4,"ion-title"),l(5,"Usuarios"),n(),a(6,"ion-buttons",2)(7,"ion-button",3),u("click",function(){return i.createUser()}),d(8,"ion-icon",4),n()()()(),a(9,"ion-content",5)(10,"div",6)(11,"div",7)(12,"h1"),l(13,"\u{1F680} Gesti\xF3n de Usuarios"),n(),a(14,"div",8)(15,"div",9),u("click",function(){return i.clearFilters()}),d(16,"ion-icon",10),a(17,"div")(18,"span",11),l(19),n(),a(20,"span",12),l(21,"Total"),n()()(),a(22,"div",13),u("click",function(){return i.onStatusChange({detail:{value:!0}})}),d(23,"ion-icon",14),a(24,"div")(25,"span",11),l(26),n(),a(27,"span",12),l(28,"Activos"),n()()(),a(29,"div",15),u("click",function(){return i.onStatusChange({detail:{value:!1}})}),d(30,"ion-icon",16),a(31,"div")(32,"span",11),l(33),n(),a(34,"span",12),l(35,"Inactivos"),n()()(),a(36,"div",17),u("click",function(){return i.onRoleChange({detail:{value:i.Role.ADMIN}})}),d(37,"ion-icon",18),a(38,"div")(39,"span",11),l(40),n(),a(41,"span",12),l(42,"Admins"),n()()()()(),a(43,"div",19)(44,"ion-searchbar",20),I("ngModelChange",function(m){return U(i.searchTerm,m)||(i.searchTerm=m),m}),u("ionInput",function(m){return i.onSearch(m)}),n(),a(45,"div",21)(46,"ion-item",22)(47,"ion-select",23),I("ngModelChange",function(m){return U(i.selectedRole,m)||(i.selectedRole=m),m}),u("ionChange",function(m){return i.onRoleChange(m)}),a(48,"ion-select-option",24),l(49,"Todos los roles"),n(),a(50,"ion-select-option",25),l(51,"\u{1F6E1}\uFE0F Administrador"),n(),a(52,"ion-select-option",25),l(53,"\u{1F3EA} Gerente de Mercado"),n(),a(54,"ion-select-option",25),l(55,"\u{1F464} Usuario"),n()()(),a(56,"ion-item",22)(57,"ion-select",26),I("ngModelChange",function(m){return U(i.selectedStatus,m)||(i.selectedStatus=m),m}),u("ionChange",function(m){return i.onStatusChange(m)}),a(58,"ion-select-option",24),l(59,"Todos los estados"),n(),a(60,"ion-select-option",25),l(61,"\u2705 Activos"),n(),a(62,"ion-select-option",25),l(63,"\u274C Inactivos"),n()()(),k(64,kt,5,2,"ion-item",27),a(65,"ion-button",28),u("click",function(){return i.clearFilters()}),d(66,"ion-icon",29),a(67,"span"),l(68,"Limpiar"),n()()()()(),a(69,"div",30)(70,"ion-refresher",31),u("ionRefresh",function(m){return i.doRefresh(m)}),d(71,"ion-refresher-content",32),n(),k(72,yt,4,0,"div",33)(73,Ot,46,38,"div",34),a(74,"ion-infinite-scroll",35),u("ionInfinite",function(m){return i.loadMore(m)}),d(75,"ion-infinite-scroll-content",36),n(),a(76,"ion-fab",37)(77,"ion-fab-button",38),u("click",function(){return i.createUser()}),d(78,"ion-icon",4),n()()()()),t&2&&(p("translucent",!0),o(9),p("fullscreen",!0),o(10),y(i.usuarios().length||0),o(7),y(i.getActiveUsersCount()),o(7),y(i.getInactiveUsersCount()),o(7),y(i.getAdminUsersCount()),o(4),O("ngModel",i.searchTerm),o(3),O("ngModel",i.selectedRole),o(3),p("value",i.Role.ADMIN),o(2),p("value",i.Role.MARKET),o(2),p("value",i.Role.USER),o(3),O("ngModel",i.selectedStatus),o(3),p("value",!0),o(2),p("value",!1),o(2),p("ngIf",i.availableGerencias().length>0),o(8),p("ngIf",i.loading()),o(),p("ngIf",!i.loading()),o(),p("disabled",i.currentPage()>=i.totalPages()))},dependencies:[V,ne,D,pe,F,le,B,$,q,W,N,Ce,R,Z,Ie,j,Pe,Se,xe,ke,we,_e,Te,Me,G,Oe],styles:[`:root{--usuarios-primary: #3880ff;--usuarios-success: #2dd36f;--usuarios-warning: #ffc409;--usuarios-danger: #eb445a;--usuarios-medium: #92949c;--usuarios-light: #f4f5f8;--usuarios-dark: #222428;--glass-bg: rgba(255, 255, 255, .05);--glass-border: rgba(255, 255, 255, .1);--glass-blur: 10px;--shadow-sm: 0 2px 4px rgba(0, 0, 0, .05);--shadow-md: 0 4px 6px rgba(0, 0, 0, .1);--shadow-lg: 0 10px 25px rgba(0, 0, 0, .1);--shadow-xl: 0 20px 40px rgba(0, 0, 0, .15);--radius-sm: 8px;--radius-md: 12px;--radius-lg: 16px;--radius-xl: 20px;--transition-fast: .15s ease;--transition-normal: .3s ease;--transition-slow: .5s ease}.users-page{background:linear-gradient(135deg,#667eea,#764ba2);min-height:100vh;padding-bottom:100px}.users-page:before{content:"";position:fixed;top:0;left:0;right:0;bottom:0;background:radial-gradient(circle at 20% 80%,rgba(120,119,198,.3) 0%,transparent 50%),radial-gradient(circle at 80% 20%,rgba(255,119,198,.3) 0%,transparent 50%),radial-gradient(circle at 40% 40%,rgba(120,219,255,.2) 0%,transparent 50%);pointer-events:none;z-index:0}.users-page .main-content{position:relative;z-index:1;padding:0 1.5rem;padding-bottom:120px}.sticky-header{background:#ffffffe6;-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);border-bottom:1px solid rgba(255,255,255,.2);box-shadow:var(--shadow-lg);padding:2.5rem 2rem;margin:0 0 3rem;border-radius:var(--radius-xl);transition:var(--transition-normal)}.sticky-header:hover{background:#fffffff2}.sticky-header .header-stats{margin-bottom:2rem}.sticky-header .header-stats h1{font-size:2rem;font-weight:700;background:linear-gradient(135deg,var(--usuarios-primary),#764ba2);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;margin-bottom:2rem;text-align:center}.sticky-header .header-stats .stats-cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(170px,1fr));gap:2rem;margin-bottom:2rem}.sticky-header .header-stats .stats-cards .stat-item{background:#fffc;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.3);border-radius:var(--radius-lg);padding:1.75rem 1.5rem;display:flex;align-items:center;gap:1.25rem;transition:var(--transition-normal);cursor:pointer;position:relative;overflow:hidden}.sticky-header .header-stats .stats-cards .stat-item:before{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.4),transparent);transition:var(--transition-slow)}.sticky-header .header-stats .stats-cards .stat-item:hover{transform:translateY(-4px);box-shadow:var(--shadow-xl)}.sticky-header .header-stats .stats-cards .stat-item:hover:before{left:100%}.sticky-header .header-stats .stats-cards .stat-item ion-icon{font-size:2rem;padding:.75rem;border-radius:var(--radius-md);background:var(--usuarios-light);min-width:2rem;display:flex;align-items:center;justify-content:center;box-shadow:0 2px 8px #0000001a;color:var(--usuarios-primary);transition:all .3s ease}.sticky-header .header-stats .stats-cards .stat-item.success ion-icon{color:#10b981;background:#10b98126}.sticky-header .header-stats .stats-cards .stat-item.pending ion-icon{color:#f59e0b;background:#f59e0b26}.sticky-header .header-stats .stats-cards .stat-item.admin ion-icon{color:#ef4444;background:#ef444426}.sticky-header .header-stats .stats-cards .stat-item .stat-number{font-size:1.375rem;font-weight:700;color:var(--usuarios-dark);line-height:1.2}.sticky-header .header-stats .stats-cards .stat-item .stat-label{font-size:.8rem;color:var(--usuarios-medium);text-transform:uppercase;letter-spacing:.5px;line-height:1.2}.sticky-header .search-filters{margin-top:2.5rem}.sticky-header .search-filters ion-searchbar{--background: rgba(255, 255, 255, .9);--border-radius: var(--radius-lg);--box-shadow: 0 4px 15px rgba(0, 0, 0, .1);--color: var(--usuarios-dark);--placeholder-color: var(--usuarios-medium);--placeholder-font-weight: 500;--icon-color: #3b82f6;--clear-button-color: #6b7280;margin-bottom:2rem;border:none!important;border-radius:var(--radius-lg)}.sticky-header .search-filters ion-searchbar:hover{--background: rgba(255, 255, 255, 1);--box-shadow: 0 6px 20px rgba(0, 0, 0, .15);--icon-color: #1d4ed8}.sticky-header .search-filters ion-searchbar:focus-within{--box-shadow: 0 0 0 3px rgba(59, 130, 246, .1), 0 6px 20px rgba(0, 0, 0, .15);border:none!important;--icon-color: #1d4ed8}.sticky-header .search-filters .filters-row{display:flex;gap:1.5rem;flex-wrap:wrap;align-items:stretch;justify-content:flex-start}.sticky-header .search-filters .filters-row .filter-item{--background: rgba(255, 255, 255, .9);--border-radius: var(--radius-lg);--box-shadow: 0 4px 15px rgba(0, 0, 0, .1);--padding-start: 1.25rem;--padding-end: 1.25rem;--min-height: 56px;border:1px solid rgba(226,232,240,.6);flex:1;min-width:200px;margin-bottom:.5rem;transition:all .3s cubic-bezier(.4,0,.2,1);border-radius:var(--radius-lg);overflow:visible;z-index:1}.sticky-header .search-filters .filters-row .filter-item:hover{--background: rgba(255, 255, 255, 1);--box-shadow: 0 6px 20px rgba(0, 0, 0, .15);transform:translateY(-2px);border-color:#3b82f633;z-index:2}.sticky-header .search-filters .filters-row .filter-item:focus-within{--box-shadow: 0 0 0 3px rgba(59, 130, 246, .1), 0 6px 20px rgba(0, 0, 0, .15);border-color:#3b82f64d;z-index:3}.sticky-header .search-filters .filters-row .filter-item ion-select{--placeholder-color: var(--usuarios-medium);--color: var(--usuarios-dark);font-weight:500;min-height:48px;line-height:1.4}.sticky-header .search-filters .filters-row .filter-item ion-select ion-icon{color:#3b82f6!important}.sticky-header .search-filters .filters-row .filter-item ion-label{position:static!important;transform:none!important;font-size:14px;font-weight:500;color:var(--usuarios-medium);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.sticky-header .search-filters .filters-row .clear-filters-btn{--background: linear-gradient(135deg, var(--usuarios-warning), #ff6b6b);--color: white;--border-radius: var(--radius-lg);--box-shadow: 0 4px 15px rgba(0, 0, 0, .1);transition:all .3s cubic-bezier(.4,0,.2,1);padding:0 2rem;height:52px;font-weight:600;border:none!important;outline:none!important;position:relative}.sticky-header .search-filters .filters-row .clear-filters-btn:hover{--box-shadow: 0 6px 20px rgba(0, 0, 0, .2);transform:translateY(-2px) scale(1.02);z-index:10}.sticky-header .search-filters .filters-row .clear-filters-btn ion-icon{font-size:1.25rem;margin-right:.5rem;color:#fff}.sticky-header .search-filters .filters-row .clear-filters-btn:hover{transform:translateY(-2px);--box-shadow: var(--shadow-lg)}.desktop-table{margin-bottom:3rem}.desktop-table .modern-table-wrapper{background:#ffffffe6;-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);border:1px solid rgba(255,255,255,.2);border-radius:var(--radius-xl);box-shadow:var(--shadow-xl);overflow:hidden;margin:2rem 0 3rem;transition:var(--transition-normal)}.desktop-table .modern-table-wrapper:hover{box-shadow:0 25px 50px #0003}.desktop-table .modern-table-wrapper .table-toolbar{background:linear-gradient(135deg,var(--usuarios-primary),#764ba2);color:#fff;padding:1rem 1.5rem;display:flex;justify-content:space-between;align-items:center;animation:slideInDown .5s ease}.desktop-table .modern-table-wrapper .table-toolbar .selection-info{display:flex;align-items:center;gap:.5rem;font-weight:600}.desktop-table .modern-table-wrapper .table-toolbar .selection-info ion-icon{font-size:1.25rem}.desktop-table .modern-table-wrapper .table-toolbar .bulk-actions{display:flex;gap:.5rem}.desktop-table .modern-table-wrapper .table-toolbar .bulk-actions ion-button{--border-radius: var(--radius-sm);--background: rgba(255, 255, 255, .15);--color: white;--border-color: rgba(255, 255, 255, .3);transition:var(--transition-fast)}.desktop-table .modern-table-wrapper .table-toolbar .bulk-actions ion-button:hover{--background: rgba(255, 255, 255, .25);transform:translateY(-1px)}.desktop-table .modern-table-wrapper .table-header{background:linear-gradient(135deg,#fffffff2,#f8fafcf2);border-bottom:2px solid rgba(56,128,255,.1);padding:1.25rem 2rem;display:grid;grid-template-columns:60px 1.8fr 1.6fr 1fr .9fr .9fr 1.1fr 1fr;gap:1.5rem;align-items:center;font-weight:600;color:var(--usuarios-dark)}.desktop-table .modern-table-wrapper .table-header .header-cell{display:flex;align-items:center;font-size:.875rem;text-transform:uppercase;letter-spacing:.5px}.desktop-table .modern-table-wrapper .table-header .header-cell.sortable-header{cursor:pointer;-webkit-user-select:none;user-select:none;transition:var(--transition-fast);padding:.75rem;border-radius:var(--radius-sm);position:relative}.desktop-table .modern-table-wrapper .table-header .header-cell.sortable-header:hover{background:#3880ff0d;color:var(--usuarios-primary)}.desktop-table .modern-table-wrapper .table-header .header-cell.sortable-header.active{color:var(--usuarios-primary);background:#3880ff1a}.desktop-table .modern-table-wrapper .table-header .header-cell.sortable-header .sort-indicators{display:flex;flex-direction:column;margin-left:.75rem;gap:-2px}.desktop-table .modern-table-wrapper .table-header .header-cell.sortable-header .sort-indicators .sort-icon{font-size:.75rem;opacity:.3;transition:var(--transition-fast)}.desktop-table .modern-table-wrapper .table-header .header-cell.sortable-header .sort-indicators .sort-icon.active{opacity:1;color:var(--usuarios-primary)}.desktop-table .modern-table-wrapper .table-header .header-cell .select-all-checkbox{--checkbox-background: rgba(255, 255, 255, .9);--border-radius: var(--radius-sm);--border-color: rgba(56, 128, 255, .3);--checkmark-color: var(--usuarios-primary)}.desktop-table .modern-table-wrapper .table-body .table-row{display:grid;grid-template-columns:60px 1.8fr 1.6fr 1fr .9fr .9fr 1.1fr 1fr;gap:1.5rem;align-items:center;padding:1.25rem 2rem;border-bottom:1px solid rgba(0,0,0,.05);transition:var(--transition-fast);cursor:pointer;position:relative;min-height:75px}.desktop-table .modern-table-wrapper .table-body .table-row:before{content:"";position:absolute;left:0;top:0;bottom:0;width:4px;background:transparent;transition:var(--transition-fast)}.desktop-table .modern-table-wrapper .table-body .table-row:hover{background:#3880ff05;transform:translate(4px)}.desktop-table .modern-table-wrapper .table-body .table-row:hover:before{background:var(--usuarios-primary)}.desktop-table .modern-table-wrapper .table-body .table-row.selected{background:#3880ff0d}.desktop-table .modern-table-wrapper .table-body .table-row.selected:before{background:var(--usuarios-primary)}.desktop-table .modern-table-wrapper .table-body .table-row.inactive{opacity:.6}.desktop-table .modern-table-wrapper .table-body .table-row.inactive:before{background:var(--usuarios-medium)}.desktop-table .modern-table-wrapper .table-body .table-row.loading{opacity:.5;pointer-events:none}.desktop-table .modern-table-wrapper .table-body .table-row.loading:after{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(90deg,transparent,rgba(255,255,255,.4),transparent);animation:shimmer 1.5s infinite}.desktop-table .modern-table-wrapper .table-body .table-row .table-cell{display:flex;align-items:center}.desktop-table .modern-table-wrapper .table-body .table-row .table-cell .row-checkbox{--checkbox-background: white;--border-radius: var(--radius-sm);--border-color: rgba(56, 128, 255, .3);--checkmark-color: var(--usuarios-primary)}.desktop-table .modern-table-wrapper .table-body .table-row .table-cell.user-col .user-info{display:flex;align-items:center;gap:1rem}.desktop-table .modern-table-wrapper .table-body .table-row .table-cell.user-col .user-info .user-avatar{width:48px;height:48px;border-radius:50%;background:linear-gradient(135deg,var(--usuarios-primary),#764ba2);color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:.95rem;box-shadow:var(--shadow-md);border:3px solid rgba(255,255,255,.8);transition:var(--transition-fast)}.desktop-table .modern-table-wrapper .table-body .table-row .table-cell.user-col .user-info .user-details .user-name{font-weight:600;color:var(--usuarios-dark);margin-bottom:.375rem;font-size:.95rem;line-height:1.3}.desktop-table .modern-table-wrapper .table-body .table-row .table-cell.user-col .user-info .user-details .user-username{color:var(--usuarios-medium);font-size:.825rem;font-weight:500;line-height:1.3}.desktop-table .modern-table-wrapper .table-body .table-row .table-cell .cell-text{color:var(--usuarios-dark);font-size:.9rem;font-weight:500;line-height:1.4}.desktop-table .modern-table-wrapper .table-body .table-row .table-cell.role-col .role-badge{padding:.375rem .75rem;border-radius:var(--radius-lg);font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.5px;border:1px solid}.desktop-table .modern-table-wrapper .table-body .table-row .table-cell.role-col .role-badge.admin{background:linear-gradient(135deg,#eb445a1a,#eb445a0d);color:var(--usuarios-danger);border-color:#eb445a33}.desktop-table .modern-table-wrapper .table-body .table-row .table-cell.role-col .role-badge.market{background:linear-gradient(135deg,#ffc4091a,#ffc4090d);color:var(--usuarios-warning);border-color:#ffc40933}.desktop-table .modern-table-wrapper .table-body .table-row .table-cell.role-col .role-badge.user{background:linear-gradient(135deg,#3880ff1a,#3880ff0d);color:var(--usuarios-primary);border-color:#3880ff33}.desktop-table .modern-table-wrapper .table-body .table-row .table-cell.status-col .status-badge{display:flex;align-items:center;gap:.5rem;padding:.375rem .75rem;border-radius:var(--radius-lg);font-size:.75rem;font-weight:600;background:linear-gradient(135deg,#2dd36f1a,#2dd36f0d);color:var(--usuarios-success);border:1px solid rgba(45,211,111,.2)}.desktop-table .modern-table-wrapper .table-body .table-row .table-cell.status-col .status-badge.inactive{background:linear-gradient(135deg,#92949c1a,#92949c0d);color:var(--usuarios-medium);border-color:#92949c33}.desktop-table .modern-table-wrapper .table-body .table-row .table-cell.status-col .status-badge .status-dot{width:8px;height:8px;border-radius:50%;background:currentColor}.desktop-table .modern-table-wrapper .table-body .table-row .table-cell.actions-col .action-buttons{display:flex;gap:.75rem}.desktop-table .modern-table-wrapper .table-body .table-row .table-cell.actions-col .action-buttons .action-btn{width:40px;height:40px;border:none;border-radius:var(--radius-sm);background:#fffc;color:var(--usuarios-medium);display:flex;align-items:center;justify-content:center;cursor:pointer;transition:var(--transition-fast);box-shadow:var(--shadow-sm)}.desktop-table .modern-table-wrapper .table-body .table-row .table-cell.actions-col .action-buttons .action-btn:hover{transform:translateY(-2px);box-shadow:var(--shadow-md)}.desktop-table .modern-table-wrapper .table-body .table-row .table-cell.actions-col .action-buttons .action-btn.view-btn:hover{background:#3880ff26;color:#3b82f6}.desktop-table .modern-table-wrapper .table-body .table-row .table-cell.actions-col .action-buttons .action-btn.edit-btn:hover{background:#f59e0b26;color:#f59e0b}.desktop-table .modern-table-wrapper .table-body .table-row .table-cell.actions-col .action-buttons .action-btn.password-btn:hover{background:#6b728026;color:#6b7280}.desktop-table .modern-table-wrapper .table-body .table-row .table-cell.actions-col .action-buttons .action-btn.toggle-btn.activate:hover{background:#10b98126;color:#10b981}.desktop-table .modern-table-wrapper .table-body .table-row .table-cell.actions-col .action-buttons .action-btn.toggle-btn.deactivate:hover{background:#ef444426;color:#ef4444}.desktop-table .modern-table-wrapper .table-body .table-row .table-cell.actions-col .action-buttons .action-btn ion-icon{font-size:1.25rem;font-weight:500}.mobile-cards{display:none}@media (max-width: 768px){.mobile-cards{display:block}.mobile-cards .user-card{background:#ffffffe6;-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);border:1px solid rgba(255,255,255,.2);border-radius:var(--radius-lg);margin-bottom:1rem;padding:1.25rem;box-shadow:var(--shadow-lg);transition:var(--transition-normal);cursor:pointer}.mobile-cards .user-card:hover{transform:translateY(-4px);box-shadow:var(--shadow-xl)}.mobile-cards .user-card.inactive{opacity:.6}.mobile-cards .user-card .card-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.mobile-cards .user-card .card-header .user-info{display:flex;align-items:center;gap:.75rem}.mobile-cards .user-card .card-header .user-info .user-avatar{width:48px;height:48px;border-radius:50%;background:linear-gradient(135deg,var(--usuarios-primary),#764ba2);color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700;box-shadow:var(--shadow-md)}.mobile-cards .user-card .card-header .user-info .user-details .user-name{font-weight:600;color:var(--usuarios-dark);margin-bottom:.25rem}.mobile-cards .user-card .card-header .user-info .user-details .user-email{color:var(--usuarios-medium);font-size:.875rem}.mobile-cards .user-card .card-header .user-status .status-badge{width:12px;height:12px;border-radius:50%;background:var(--usuarios-success)}.mobile-cards .user-card .card-header .user-status .status-badge.inactive{background:var(--usuarios-medium)}.mobile-cards .user-card .card-content .info-row{display:flex;justify-content:space-between;align-items:center;margin-bottom:.5rem}.mobile-cards .user-card .card-content .info-row .label{font-weight:600;color:var(--usuarios-medium);font-size:.875rem}.mobile-cards .user-card .card-content .info-row .value{color:var(--usuarios-dark);font-weight:500}.mobile-cards .user-card .card-content .info-row .role-badge.mobile{padding:.25rem .5rem;border-radius:var(--radius-sm);font-size:.75rem;font-weight:600}.mobile-cards .user-card .card-actions{display:flex;justify-content:center;gap:1rem;margin-top:1rem;padding-top:1rem;border-top:1px solid rgba(0,0,0,.1)}.mobile-cards .user-card .card-actions .mobile-action-btn{width:44px;height:44px;border:none;border-radius:50%;background:#fffc;color:var(--usuarios-medium);display:flex;align-items:center;justify-content:center;cursor:pointer;transition:var(--transition-fast);box-shadow:var(--shadow-sm)}.mobile-cards .user-card .card-actions .mobile-action-btn:hover{transform:translateY(-2px);box-shadow:var(--shadow-md)}.mobile-cards .user-card .card-actions .mobile-action-btn.edit:hover{background:#f59e0b26;color:#f59e0b}.mobile-cards .user-card .card-actions .mobile-action-btn.password:hover{background:#6b728026;color:#6b7280}.mobile-cards .user-card .card-actions .mobile-action-btn.toggle.activate:hover{background:#10b98126;color:#10b981}.mobile-cards .user-card .card-actions .mobile-action-btn.toggle.deactivate:hover{background:#ef444426;color:#ef4444}.mobile-cards .user-card .card-actions .mobile-action-btn ion-icon{font-size:1.25rem;font-weight:500}}.empty-state{text-align:center;padding:4rem 2rem 5rem;background:#ffffffe6;-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);border:1px solid rgba(255,255,255,.2);border-radius:var(--radius-xl);margin:2rem 0 4rem;box-shadow:var(--shadow-lg)}.empty-state ion-icon{color:var(--usuarios-medium);margin-bottom:1.5rem}.empty-state h3{color:var(--usuarios-dark);margin-bottom:1rem;font-weight:600;font-size:1.25rem}.empty-state p{color:var(--usuarios-medium);margin-bottom:2rem;font-size:1rem;line-height:1.5}.empty-state ion-button{--background: linear-gradient(135deg, var(--usuarios-primary), #764ba2);--color: white;--border-radius: var(--radius-lg);--box-shadow: var(--shadow-md);transition:var(--transition-normal);--padding-start: 2rem;--padding-end: 2rem;--height: 48px}.empty-state ion-button:hover{transform:translateY(-2px);--box-shadow: var(--shadow-lg)}ion-infinite-scroll{margin-top:2rem;margin-bottom:2rem}ion-infinite-scroll ion-infinite-scroll-content{padding:2rem 0;color:var(--usuarios-medium);font-weight:500}ion-infinite-scroll ion-infinite-scroll-content .infinite-loading{display:flex;flex-direction:column;align-items:center;gap:1rem}ion-infinite-scroll ion-infinite-scroll-content .infinite-loading ion-spinner{--color: var(--usuarios-primary)}ion-fab{position:fixed!important;bottom:2rem;right:2rem;z-index:1000}ion-fab-button{--background: linear-gradient(135deg, #3b82f6, #1d4ed8);--color: white !important;--box-shadow: 0 8px 25px rgba(59, 130, 246, .4);--border-radius: 50%;width:64px;height:64px;transition:all .3s cubic-bezier(.4,0,.2,1);border:none!important;outline:none!important}ion-fab-button:hover{transform:scale(1.1) rotate(90deg);--box-shadow: 0 12px 35px rgba(59, 130, 246, .5);--background: linear-gradient(135deg, #1d4ed8, #3b82f6)}ion-fab-button:active{transform:scale(.95)}ion-fab-button:focus{outline:none!important;border:none!important}ion-fab-button ion-icon{font-size:2rem;font-weight:700;color:#fff!important;filter:drop-shadow(0 2px 4px rgba(0,0,0,.2))}.loading-container{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:4rem 2rem;margin:2rem 0;background:#ffffffe6;-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);border:1px solid rgba(255,255,255,.2);border-radius:var(--radius-xl);box-shadow:var(--shadow-lg);min-height:200px}.loading-container ion-spinner{--color: var(--usuarios-primary);margin-bottom:1.5rem;transform:scale(1.2)}.loading-container p{color:var(--usuarios-medium);font-size:1rem;font-weight:500;text-align:center;margin:0}@keyframes slideInDown{0%{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}@keyframes shimmer{0%{transform:translate(-100%)}to{transform:translate(100%)}}@keyframes fadeInUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.table-row{animation:fadeInUp .5s ease forwards}.table-row:nth-child(1){animation-delay:.05s}.table-row:nth-child(2){animation-delay:.1s}.table-row:nth-child(3){animation-delay:.15s}.table-row:nth-child(4){animation-delay:.2s}.table-row:nth-child(5){animation-delay:.25s}.table-row:nth-child(6){animation-delay:.3s}.table-row:nth-child(7){animation-delay:.35s}.table-row:nth-child(8){animation-delay:.4s}.table-row:nth-child(9){animation-delay:.45s}.table-row:nth-child(10){animation-delay:.5s}@media (max-width: 1200px){.table-header,.table-row{grid-template-columns:50px 1.5fr 1.3fr .8fr .8fr .8fr 1fr .9fr!important;gap:1.25rem!important;padding:1rem 1.5rem!important}.sticky-header{padding:1.5rem 1rem}}@media (max-width: 968px){.desktop-table{display:none}.mobile-cards{display:block}.users-page .main-content{padding:0 1rem;padding-bottom:100px}}@media (max-width: 576px){.sticky-header{padding:1.25rem .75rem;margin:0 -1rem 2rem}.sticky-header .header-stats h1{font-size:1.5rem;margin-bottom:1.5rem}.sticky-header .header-stats .stats-cards{grid-template-columns:repeat(2,1fr);gap:1rem}.sticky-header .header-stats .stats-cards .stat-item{padding:1rem}.sticky-header .search-filters .filters-row{flex-direction:column;gap:1rem;align-items:stretch}.sticky-header .search-filters .filters-row .filter-item{min-width:100%;margin-bottom:.75rem;--min-height: 52px}.sticky-header .search-filters .filters-row .clear-filters-btn{align-self:stretch;--height: 52px;margin-top:.5rem}.users-page .main-content{padding:0 .75rem;padding-bottom:140px}ion-fab{position:fixed!important;bottom:1.5rem!important;right:1.5rem!important;z-index:1001!important}ion-fab-button{width:56px!important;height:56px!important;--box-shadow: 0 6px 20px rgba(59, 130, 246, .5) !important}ion-fab-button ion-icon{font-size:1.75rem!important}}.select-col{width:60px!important;min-width:60px!important;max-width:60px!important}.select-col .select-all-checkbox,.select-col .row-checkbox{--size: 18px !important;margin:0!important}@media (max-width: 768px){.modern-table-wrapper .table-header,.modern-table-wrapper .table-row{grid-template-columns:50px 1.4fr 1.6fr .9fr .7fr .7fr .9fr .7fr!important;padding:.3rem .5rem!important;min-height:45px!important}.select-col{width:50px!important;min-width:50px!important;max-width:50px!important}}.users-page .filter-item{contain:layout style}.users-page ion-select{--z-index: 1000}.users-page .sticky-header{padding-bottom:1rem}
`],encapsulation:2});let c=b;return c})();export{ei as UsuariosListPage};
