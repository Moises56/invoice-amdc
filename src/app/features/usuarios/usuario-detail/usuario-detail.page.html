<ion-header class="safe-area-header usuario-detail-header">
  <div class="safe-area-spacer"></div>
  <ion-toolbar class="header-toolbar">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/usuarios"></ion-back-button>
    </ion-buttons>
    <ion-title class="header-title">
      Detalle de Usuario
    </ion-title>
    <ion-buttons slot="end" *ngIf="user() && !isLoading()">
      <ion-button (click)="editUser()" fill="clear">
        <ion-icon name="create-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="safe-area-content usuario-detail-content detail-content">
  <div class="detail-container">
    
    <!-- Loading State -->
    <div *ngIf="isLoading()" class="space-y-4">
      <ion-card class="shadow-sm">
        <ion-card-content class="p-4">
          <div class="flex items-center space-x-4 mb-4">
            <ion-skeleton-text [animated]="true" style="width: 64px; height: 64px; border-radius: 50%"></ion-skeleton-text>
            <div class="flex-1">
              <ion-skeleton-text [animated]="true" style="width: 60%"></ion-skeleton-text>
              <ion-skeleton-text [animated]="true" style="width: 40%"></ion-skeleton-text>
            </div>
          </div>
          <ion-skeleton-text [animated]="true" style="width: 100%"></ion-skeleton-text>
          <ion-skeleton-text [animated]="true" style="width: 80%"></ion-skeleton-text>
        </ion-card-content>
      </ion-card>
    </div>

    <!-- User Content -->
    <div *ngIf="!isLoading() && user()">
      
      <!-- Header Card - Span full width -->
      <ion-card class="glass-card header-card-full">
        <ion-card-content>
          <div class="user-header-content">
            <div class="user-avatar">
              <span class="avatar-text">{{ getInitials(user()) }}</span>
            </div>
            <div class="user-info">
              <h2 class="user-name">
                {{ getFullName(user()) }}
              </h2>
              <p class="user-username">{{ user()?.username }}</p>
              <div class="user-badges">
                <ion-chip [color]="getRoleColor(user()!.role)" class="role-chip">
                  {{ getRoleText(user()!.role) }}
                </ion-chip>
                <ion-chip 
                  [color]="user()?.isActive ? 'success' : 'danger'" 
                  class="status-chip">
                  <ion-icon 
                    [name]="user()?.isActive ? 'checkmark-circle-outline' : 'close-circle-outline'" 
                    slot="start">
                  </ion-icon>
                  {{ user()?.isActive ? 'Activo' : 'Inactivo' }}
                </ion-chip>
              </div>
            </div>
          </div>
        </ion-card-content>
      </ion-card>

      <!-- Grid de cards responsive -->
      <div class="cards-grid">
        <!-- Contact Information -->
        <ion-card class="glass-card">
          <ion-card-header class="card-header-modern">
            <ion-card-title class="card-title-glass">
              <div class="title-icon">
                <ion-icon name="mail-outline"></ion-icon>
              </div>
              Información de Contacto
            </ion-card-title>
          </ion-card-header>
          
          <ion-card-content class="card-content-modern">
            <div class="info-item">
              <ion-icon name="mail-outline" class="item-icon"></ion-icon>
              <div class="item-content">
                <h3 class="item-title">Correo Electrónico</h3>
                <p class="item-value">{{ user()?.correo }}</p>
              </div>
            </div>
            
            <div class="info-item" *ngIf="user()?.telefono">
              <ion-icon name="call-outline" class="item-icon"></ion-icon>
              <div class="item-content">
                <h3 class="item-title">Teléfono</h3>
                <p class="item-value">{{ user()?.telefono }}</p>
              </div>
            </div>
            
            <div class="info-item" *ngIf="user()?.dni">
              <ion-icon name="card-outline" class="item-icon"></ion-icon>
              <div class="item-content">
                <h3 class="item-title">DNI</h3>
                <p class="item-value">{{ user()?.dni }}</p>
              </div>
            </div>
          </ion-card-content>
        </ion-card>

        <!-- Work Information -->
        <ion-card class="glass-card">
          <ion-card-header class="card-header-modern">
            <ion-card-title class="card-title-glass">
              <div class="title-icon">
                <ion-icon name="briefcase-outline"></ion-icon>
              </div>
              Información Laboral
            </ion-card-title>
          </ion-card-header>
          
          <ion-card-content class="card-content-modern">
            <div class="info-item" *ngIf="user()?.gerencia">
              <ion-icon name="business-outline" class="item-icon"></ion-icon>
              <div class="item-content">
                <h3 class="item-title">Gerencia</h3>
                <p class="item-value">{{ user()?.gerencia }}</p>
              </div>
            </div>
            
            <div class="info-item" *ngIf="user()?.numero_empleado">
              <ion-icon name="keypad-outline" class="item-icon"></ion-icon>
              <div class="item-content">
                <h3 class="item-title">Número de Empleado</h3>
                <p class="item-value">{{ user()?.numero_empleado }}</p>
              </div>
            </div>
            
            <div class="info-item">
              <ion-icon name="key-outline" class="item-icon"></ion-icon>
              <div class="item-content">
                <h3 class="item-title">Usuario del Sistema</h3>
                <p class="item-value">{{ user()?.username }}</p>
              </div>
            </div>
          </ion-card-content>
        </ion-card>

        <!-- System Information -->
        <ion-card class="glass-card">
          <ion-card-header class="card-header-modern">
            <ion-card-title class="card-title-glass">
              <div class="title-icon">
                <ion-icon name="settings-outline"></ion-icon>
              </div>
              Información del Sistema
            </ion-card-title>
          </ion-card-header>
          
          <ion-card-content class="card-content-modern">
            <div class="info-item">
              <ion-icon name="person-outline" class="item-icon"></ion-icon>
              <div class="item-content">
                <h3 class="item-title">ID de Usuario</h3>
                <p class="item-value item-value-mono">{{ user()?.id }}</p>
              </div>
            </div>
            
            <div class="info-item" *ngIf="user()?.createdAt">
              <ion-icon name="calendar-outline" class="item-icon"></ion-icon>
              <div class="item-content">
                <h3 class="item-title">Fecha de Creación</h3>
                <p class="item-value">{{ user()?.createdAt | date:'medium' }}</p>
              </div>
            </div>
            
            <div class="info-item" *ngIf="user()?.updatedAt">
              <ion-icon name="refresh-outline" class="item-icon"></ion-icon>
              <div class="item-content">
                <h3 class="item-title">Última Actualización</h3>
                <p class="item-value">{{ user()?.updatedAt | date:'medium' }}</p>
              </div>
            </div>
          </ion-card-content>
        </ion-card>
      </div>

      <!-- Actions -->
      <div class="action-buttons">
        <ion-button 
          fill="solid"
          (click)="goBack()"
          class="secondary-btn">
          <ion-icon name="arrow-back-outline" slot="start"></ion-icon>
          Volver
        </ion-button>
        
        <ion-button 
          fill="solid"
          (click)="editUser()"
          class="primary-btn">
          <ion-icon name="create-outline" slot="start"></ion-icon>
          Editar
        </ion-button>
      </div>
    </div>

    <!-- Error State -->
    <div *ngIf="!isLoading() && !user()" class="text-center py-8">
      <ion-icon name="alert-circle-outline" class="text-6xl text-gray-400 mb-4"></ion-icon>
      <h2 class="text-xl font-semibold text-gray-700 mb-2">Usuario no encontrado</h2>
      <p class="text-gray-500 mb-4">El usuario que buscas no existe o ha sido eliminado.</p>
      <ion-button fill="outline" (click)="goBack()">
        <ion-icon name="arrow-back-outline" slot="start"></ion-icon>
        Volver a la lista
      </ion-button>
    </div>

  </div>
</ion-content>
